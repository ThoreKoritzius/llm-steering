{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/utils.ts"],"sourcesContent":["import { ColorRGB, Row } from \"./types\";\n\nexport const STYLE = {\n  titleFont: \"600 52px 'Fraunces', serif\",\n  bodyFont: \"34px 'Space Grotesk', sans-serif\",\n  metaFont: \"28px 'Space Grotesk', sans-serif\",\n  ink: \"#1a1a1a\",\n  meta: \"#4a4d50\",\n};\n\nexport function clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n\nexport function deltaToColor(delta: number, vmin: number, vmax: number): ColorRGB {\n  const neutral = { r: 247, g: 244, b: 238 };\n  if (vmax <= vmin) {\n    return { ...neutral, css: `rgb(${neutral.r},${neutral.g},${neutral.b})` };\n  }\n  const x = clamp(delta, vmin, vmax);\n  const t = (x - vmin) / (vmax - vmin);\n\n  if (t < 0.5) {\n    const a = Math.pow((0.5 - t) / 0.5, 0.7);\n    const blue = { r: 42, g: 97, b: 216 };\n    const r = Math.round(neutral.r * (1 - a) + blue.r * a);\n    const g = Math.round(neutral.g * (1 - a) + blue.g * a);\n    const b = Math.round(neutral.b * (1 - a) + blue.b * a);\n    return { r, g, b, css: `rgb(${r},${g},${b})` };\n  }\n  const a = Math.pow((t - 0.5) / 0.5, 0.7);\n  const red = { r: 217, g: 67, b: 58 };\n  const r = Math.round(neutral.r * (1 - a) + red.r * a);\n  const g = Math.round(neutral.g * (1 - a) + red.g * a);\n  const b = Math.round(neutral.b * (1 - a) + red.b * a);\n  return { r, g, b, css: `rgb(${r},${g},${b})` };\n}\n\nexport function textColorForBg(color: ColorRGB): string {\n  const luminance = 0.2126 * color.r + 0.7152 * color.g + 0.0722 * color.b;\n  return luminance < 140 ? \"#ffffff\" : \"#1a1a1a\";\n}\n\nexport function computeColorScale(rows: Row[]): { vmin: number; vmax: number } {\n  const deltas: number[] = [];\n  rows.forEach((row) => {\n    const arr = row.delta_logprobs || [];\n    arr.forEach((d) => deltas.push(d));\n  });\n  if (!deltas.length) {\n    return { vmin: -1, vmax: 1 };\n  }\n  deltas.sort((a, b) => a - b);\n  const lo = deltas[Math.floor(deltas.length * 0.05)];\n  const hi = deltas[Math.floor(deltas.length * 0.95)];\n  let vmin = Number.isFinite(lo) ? lo : -1;\n  let vmax = Number.isFinite(hi) ? hi : 1;\n  if (Math.abs(vmax - vmin) < 1e-6) {\n    vmin -= 1;\n    vmax += 1;\n  }\n  return { vmin, vmax };\n}\n\nexport function computeScaleFromDeltas(deltas: number[] | undefined): { vmin: number; vmax: number } {\n  if (!deltas || !deltas.length) {\n    return { vmin: -1, vmax: 1 };\n  }\n  const sorted = [...deltas].sort((a, b) => a - b);\n  const lo = sorted[Math.floor(sorted.length * 0.05)];\n  const hi = sorted[Math.floor(sorted.length * 0.95)];\n  let vmin = Number.isFinite(lo) ? lo : -1;\n  let vmax = Number.isFinite(hi) ? hi : 1;\n  if (Math.abs(vmax - vmin) < 1e-6) {\n    vmin -= 1;\n    vmax += 1;\n  }\n  return { vmin, vmax };\n}\n\nexport function formatTargetLabel(target: string): string {\n  if (typeof target !== \"string\") {\n    return String(target);\n  }\n  if (target.startsWith(\" \")) {\n    return `[space]${target.slice(1)}`;\n  }\n  return target;\n}\n\nexport function baselineLabel(row: Row | null): string {\n  if (!row) {\n    return \"System prompt\";\n  }\n  if (row.label) {\n    return row.label;\n  }\n  if (row.system_prompt) {\n    const text = row.system_prompt.replace(/\\s+/g, \" \").trim();\n    return text;\n  }\n  return \"System prompt\";\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 164, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/components/FrameCanvas.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef } from \"react\";\nimport { Row, SteeringData } from \"../types\";\nimport { STYLE, deltaToColor, textColorForBg } from \"../utils\";\n\ninterface FrameCanvasProps {\n  row: Row;\n  data: SteeringData | null;\n  vmin: number;\n  vmax: number;\n  options?: {\n    title?: string;\n    subtitle?: string;\n    prompt?: string;\n    maxTokens?: number | string;\n    layer?: number;\n    legendLeft?: string;\n    legendRight?: string;\n  };\n}\n\nexport default function FrameCanvas({ row, data, vmin, vmax, options = {} }: FrameCanvasProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    const width = canvas.width;\n    const height = canvas.height;\n\n    ctx.clearRect(0, 0, width, height);\n    ctx.fillStyle = \"#ffffff\";\n    ctx.fillRect(0, 0, width, height);\n    ctx.textBaseline = \"top\";\n\n    const margin = 70;\n    const lineSpacing = 10;\n    const titleY = 40;\n    const metaY = 110;\n    const bodyY = 180;\n    const maxX = width - margin;\n\n    const coeff = Number(row.coeff ?? 0).toFixed(0);\n    const layer = options.layer ?? data?.layer ?? \"\";\n    const prompt = options.prompt ?? data?.prompt ?? \"\";\n    const maxTokens = options.maxTokens ?? data?.max_new_tokens ?? \"\";\n\n    ctx.font = STYLE.titleFont;\n    ctx.fillStyle = STYLE.ink;\n    const title = options.title ?? `Steering sweep - coeff = ${coeff}  (layer ${layer})`;\n    ctx.fillText(title, margin, titleY);\n\n    ctx.font = STYLE.metaFont;\n    ctx.fillStyle = STYLE.meta;\n    const subtitle =\n      options.subtitle ??\n      `Prompt: \"${prompt}\"   |  Tokens: up to ${maxTokens}   |  Color = Delta logprob (steered - base)`;\n    ctx.fillText(subtitle, margin, metaY);\n\n    ctx.font = STYLE.bodyFont;\n    const fontSize = 34;\n    const lineHeight = fontSize + lineSpacing;\n    let x = margin;\n    let y = bodyY;\n    const padX = 6;\n    const padY = 4;\n    const tokenGap = 2;\n\n    const pieces = row.generated_pieces || [];\n    const deltas = row.delta_logprobs || [];\n\n    for (let i = 0; i < pieces.length; i += 1) {\n      const piece = pieces[i];\n      const delta = deltas[i] ?? 0;\n      const parts = String(piece).split(\"\\n\");\n      for (let pi = 0; pi < parts.length; pi += 1) {\n        const part = parts[pi];\n        if (part) {\n          const w = ctx.measureText(part).width;\n          if (x + w + padX * 2 > maxX) {\n            x = margin;\n            y += lineHeight;\n          }\n          const color = deltaToColor(delta, vmin, vmax);\n          ctx.fillStyle = color.css;\n          ctx.fillRect(x - padX, y - padY, w + padX * 2, fontSize + padY * 2);\n          ctx.fillStyle = textColorForBg(color);\n          ctx.fillText(part, x, y);\n          x += w + padX * 2 + tokenGap;\n        }\n        if (pi < parts.length - 1) {\n          x = margin;\n          y += lineHeight;\n        }\n      }\n      if (y > height - 120) {\n        break;\n      }\n    }\n\n    const legendY = height - 80;\n    ctx.font = STYLE.metaFont;\n    ctx.fillStyle = STYLE.ink;\n    const legendLeft = options.legendLeft ?? \"Less likely\";\n    const legendRight = options.legendRight ?? \"More likely\";\n    ctx.fillText(legendLeft, margin, legendY - 40);\n    ctx.fillText(legendRight, width - margin - 250, legendY - 40);\n\n    const barX0 = margin;\n    const barX1 = width - margin;\n    const barW = barX1 - barX0;\n    for (let i = 0; i < barW; i += 1) {\n      const t = i / Math.max(barW - 1, 1);\n      const d = vmin + t * (vmax - vmin);\n      ctx.strokeStyle = deltaToColor(d, vmin, vmax).css;\n      ctx.beginPath();\n      ctx.moveTo(barX0 + i, legendY);\n      ctx.lineTo(barX0 + i, legendY + 18);\n      ctx.stroke();\n    }\n  }, [row, data, vmin, vmax, options]);\n\n  return (\n    <div className=\"canvas-wrap\">\n      <canvas ref={canvasRef} width=\"1920\" height=\"1080\"></canvas>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/components/PlotCanvas.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef } from \"react\";\n\ninterface Point {\n  x: number;\n  y: number;\n}\n\ninterface Series {\n  name: string;\n  color: string;\n  points: Point[];\n  dash?: number[];\n}\n\ninterface PlotCanvasProps {\n  series: Series[];\n  markerX?: number | null;\n}\n\nexport default function PlotCanvas({ series, markerX }: PlotCanvasProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    const width = canvas.width;\n    const height = canvas.height;\n    ctx.clearRect(0, 0, width, height);\n\n    ctx.fillStyle = \"#fdfbf8\";\n    ctx.fillRect(0, 0, width, height);\n\n    const padding = { top: 24, right: 18, bottom: 30, left: 48 };\n    const chartW = width - padding.left - padding.right;\n    const chartH = height - padding.top - padding.bottom;\n\n    const allPoints = series.flatMap((s) => s.points);\n    if (!allPoints.length) {\n      ctx.fillStyle = \"#888\";\n      ctx.font = \"14px 'Space Grotesk', sans-serif\";\n      ctx.fillText(\"No data\", padding.left, padding.top + 10);\n      return;\n    }\n\n    let minX = Math.min(...allPoints.map((p) => p.x));\n    let maxX = Math.max(...allPoints.map((p) => p.x));\n    let minY = Math.min(...allPoints.map((p) => p.y));\n    let maxY = Math.max(...allPoints.map((p) => p.y));\n\n    if (minX === maxX) {\n      minX -= 1;\n      maxX += 1;\n    }\n    if (minY === maxY) {\n      minY -= 1;\n      maxY += 1;\n    }\n\n    const yPad = (maxY - minY) * 0.08;\n    minY -= yPad;\n    maxY += yPad;\n\n    const mapX = (x: number) => padding.left + ((x - minX) / (maxX - minX)) * chartW;\n    const mapY = (y: number) => padding.top + (1 - (y - minY) / (maxY - minY)) * chartH;\n\n    ctx.strokeStyle = \"rgba(0,0,0,0.08)\";\n    ctx.lineWidth = 1;\n    const gridCount = 4;\n    for (let i = 0; i <= gridCount; i += 1) {\n      const y = padding.top + (chartH / gridCount) * i;\n      ctx.beginPath();\n      ctx.moveTo(padding.left, y);\n      ctx.lineTo(padding.left + chartW, y);\n      ctx.stroke();\n    }\n\n    ctx.strokeStyle = \"rgba(0,0,0,0.2)\";\n    ctx.beginPath();\n    ctx.moveTo(padding.left, padding.top);\n    ctx.lineTo(padding.left, padding.top + chartH);\n    ctx.lineTo(padding.left + chartW, padding.top + chartH);\n    ctx.stroke();\n\n    series.forEach((s) => {\n      ctx.strokeStyle = s.color;\n      ctx.lineWidth = 2.2;\n      if (s.dash) {\n        ctx.setLineDash(s.dash);\n      }\n      ctx.beginPath();\n      s.points.forEach((p, idx) => {\n        const x = mapX(p.x);\n        const y = mapY(p.y);\n        if (idx === 0) {\n          ctx.moveTo(x, y);\n        } else {\n          ctx.lineTo(x, y);\n        }\n      });\n      ctx.stroke();\n      if (s.dash) {\n        ctx.setLineDash([]);\n      }\n    });\n\n    if (markerX != null && Number.isFinite(markerX)) {\n      const markerXPos = mapX(markerX);\n      ctx.strokeStyle = \"rgba(0,0,0,0.35)\";\n      ctx.setLineDash([4, 4]);\n      ctx.beginPath();\n      ctx.moveTo(markerXPos, padding.top);\n      ctx.lineTo(markerXPos, padding.top + chartH);\n      ctx.stroke();\n      ctx.setLineDash([]);\n\n      series.forEach((s) => {\n        const closest = s.points.reduce((acc, p) => {\n          if (!acc) return p;\n          return Math.abs(p.x - markerX) < Math.abs(acc.x - markerX) ? p : acc;\n        }, null as Point | null);\n        if (closest) {\n          const x = mapX(closest.x);\n          const y = mapY(closest.y);\n          ctx.fillStyle = s.color;\n          ctx.beginPath();\n          ctx.arc(x, y, 4.5, 0, Math.PI * 2);\n          ctx.fill();\n        }\n      });\n    }\n\n    ctx.fillStyle = \"#4a4d50\";\n    ctx.font = \"12px 'Space Grotesk', sans-serif\";\n    ctx.fillText(minY.toFixed(2), 6, padding.top + chartH - 6);\n    ctx.fillText(maxY.toFixed(2), 6, padding.top + 4);\n  }, [series, markerX]);\n\n  return <canvas ref={canvasRef} width=\"640\" height=\"320\"></canvas>;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 430, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/components/HistogramCanvas.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef } from \"react\";\n\ninterface HistogramCanvasProps {\n  data: number[];\n  bins?: number;\n  title?: string;\n}\n\nexport default function HistogramCanvas({ data, bins = 50, title = \"Distribution\" }: HistogramCanvasProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !data.length) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    const width = canvas.width;\n    const height = canvas.height;\n    ctx.clearRect(0, 0, width, height);\n\n    ctx.fillStyle = \"#fdfbf8\";\n    ctx.fillRect(0, 0, width, height);\n\n    const padding = { top: 40, right: 40, bottom: 50, left: 60 };\n    const chartW = width - padding.left - padding.right;\n    const chartH = height - padding.top - padding.bottom;\n\n    // Calculate histogram\n    const min = Math.min(...data);\n    const max = Math.max(...data);\n    const binWidth = (max - min) / bins;\n\n    const histogram: number[] = new Array(bins).fill(0);\n    data.forEach((value) => {\n      const binIndex = Math.min(Math.floor((value - min) / binWidth), bins - 1);\n      histogram[binIndex]++;\n    });\n\n    const maxCount = Math.max(...histogram);\n\n    // Draw title\n    ctx.fillStyle = \"#1a1a1a\";\n    ctx.font = \"600 16px 'Space Grotesk', sans-serif\";\n    ctx.textAlign = \"center\";\n    ctx.fillText(title, width / 2, 24);\n\n    // Draw axes\n    ctx.strokeStyle = \"rgba(0,0,0,0.2)\";\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.moveTo(padding.left, padding.top);\n    ctx.lineTo(padding.left, padding.top + chartH);\n    ctx.lineTo(padding.left + chartW, padding.top + chartH);\n    ctx.stroke();\n\n    // Draw grid lines\n    ctx.strokeStyle = \"rgba(0,0,0,0.05)\";\n    ctx.lineWidth = 1;\n    const gridCount = 5;\n    for (let i = 0; i <= gridCount; i++) {\n      const y = padding.top + (chartH / gridCount) * i;\n      ctx.beginPath();\n      ctx.moveTo(padding.left, y);\n      ctx.lineTo(padding.left + chartW, y);\n      ctx.stroke();\n    }\n\n    // Draw bars\n    const barWidth = chartW / bins;\n    histogram.forEach((count, i) => {\n      const barHeight = (count / maxCount) * chartH;\n      const x = padding.left + i * barWidth;\n      const y = padding.top + chartH - barHeight;\n\n      // Gradient fill\n      const gradient = ctx.createLinearGradient(x, y, x, padding.top + chartH);\n      gradient.addColorStop(0, \"#d56a35\");\n      gradient.addColorStop(1, \"#e89a6e\");\n      ctx.fillStyle = gradient;\n      ctx.fillRect(x, y, barWidth - 1, barHeight);\n\n      // Outline\n      ctx.strokeStyle = \"rgba(213, 106, 53, 0.3)\";\n      ctx.strokeRect(x, y, barWidth - 1, barHeight);\n    });\n\n    // Draw Y-axis labels\n    ctx.fillStyle = \"#4a4d50\";\n    ctx.font = \"12px 'Space Grotesk', sans-serif\";\n    ctx.textAlign = \"right\";\n    ctx.textBaseline = \"middle\";\n    for (let i = 0; i <= gridCount; i++) {\n      const y = padding.top + (chartH / gridCount) * i;\n      const value = Math.round(maxCount * (1 - i / gridCount));\n      ctx.fillText(String(value), padding.left - 8, y);\n    }\n\n    // Draw X-axis labels\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"top\";\n    const xLabelCount = 5;\n    for (let i = 0; i <= xLabelCount; i++) {\n      const x = padding.left + (chartW / xLabelCount) * i;\n      const value = min + ((max - min) / xLabelCount) * i;\n      ctx.fillText(value.toFixed(3), x, padding.top + chartH + 8);\n    }\n\n    // Axis labels\n    ctx.fillStyle = \"#2b2f33\";\n    ctx.font = \"600 13px 'Space Grotesk', sans-serif\";\n    ctx.textAlign = \"center\";\n    ctx.fillText(\"Value\", width / 2, height - 12);\n\n    ctx.save();\n    ctx.translate(20, height / 2);\n    ctx.rotate(-Math.PI / 2);\n    ctx.fillText(\"Frequency\", 0, 0);\n    ctx.restore();\n\n    // Statistics box\n    const mean = data.reduce((a, b) => a + b, 0) / data.length;\n    const sortedData = [...data].sort((a, b) => a - b);\n    const median = sortedData[Math.floor(data.length / 2)];\n    const variance = data.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / data.length;\n    const stdDev = Math.sqrt(variance);\n\n    const statsX = padding.left + chartW - 150;\n    const statsY = padding.top + 10;\n    const statsW = 140;\n    const statsH = 90;\n\n    ctx.fillStyle = \"rgba(255, 255, 255, 0.95)\";\n    ctx.fillRect(statsX, statsY, statsW, statsH);\n    ctx.strokeStyle = \"rgba(0, 0, 0, 0.1)\";\n    ctx.lineWidth = 1;\n    ctx.strokeRect(statsX, statsY, statsW, statsH);\n\n    ctx.fillStyle = \"#2b2f33\";\n    ctx.font = \"600 12px 'Space Grotesk', sans-serif\";\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"top\";\n\n    const stats = [\n      `Dimensions: ${data.length}`,\n      `Mean: ${mean.toFixed(4)}`,\n      `Median: ${median.toFixed(4)}`,\n      `Std Dev: ${stdDev.toFixed(4)}`,\n      `Range: [${min.toFixed(3)}, ${max.toFixed(3)}]`,\n    ];\n\n    stats.forEach((stat, i) => {\n      ctx.fillText(stat, statsX + 8, statsY + 8 + i * 16);\n    });\n  }, [data, bins, title]);\n\n  return (\n    <div className=\"canvas-wrap\">\n      <canvas ref={canvasRef} width=\"960\" height=\"480\"></canvas>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 595, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, ChangeEvent } from \"react\";\nimport { AppState, SteeringData, BaselineData, Row, SteeringVector } from \"./types\";\nimport {\n  computeColorScale,\n  computeScaleFromDeltas,\n  formatTargetLabel,\n  baselineLabel,\n} from \"./utils\";\nimport FrameCanvas from \"./components/FrameCanvas\";\nimport PlotCanvas from \"./components/PlotCanvas\";\nimport HistogramCanvas from \"./components/HistogramCanvas\";\n\nconst ARCH_LAYER_COUNT = 42;\n\nexport default function Home() {\n  const [state, setState] = useState<AppState>({\n    data: null,\n    rows: [],\n    coeffs: [],\n    targets: [],\n    selectedTarget: null,\n    currentIndex: 0,\n    vmin: -1,\n    vmax: 1,\n    baseline: null,\n    steeringVector: null,\n    activeTab: \"frame\",\n  });\n\n  const [status, setStatus] = useState(\"Waiting for data...\");\n\n  const loadJsonData = (data: SteeringData) => {\n    if (!data || !Array.isArray(data.rows)) {\n      setStatus(\"Invalid JSON: missing rows\");\n      return;\n    }\n\n    const rows = [...data.rows].sort((a, b) => (a.coeff ?? 0) - (b.coeff ?? 0));\n    const coeffs = rows.map((r) => Number(r.coeff ?? 0));\n\n    const targets = Array.isArray(data.targets) ? data.targets : [];\n    let finalTargets = targets;\n    if (!targets.length) {\n      const keys: string[] = [];\n      rows.forEach((row) => {\n        [\"targets\", \"targets_first_token\"].forEach((key) => {\n          const value = row[key as keyof Row];\n          if (value && typeof value === \"object\") {\n            keys.push(...Object.keys(value));\n          }\n        });\n      });\n      finalTargets = [...new Set(keys)];\n    }\n\n    const scale = data.delta_color_scale || {};\n    let vmin = Number.isFinite(scale.vmin_p5) ? scale.vmin_p5! : -1;\n    let vmax = Number.isFinite(scale.vmax_p95) ? scale.vmax_p95! : 1;\n    if (!Number.isFinite(vmin) || !Number.isFinite(vmax)) {\n      const computed = computeColorScale(rows);\n      vmin = computed.vmin;\n      vmax = computed.vmax;\n    }\n\n    setState((prev) => ({\n      ...prev,\n      data,\n      rows,\n      coeffs,\n      targets: finalTargets,\n      selectedTarget: finalTargets[0] || null,\n      currentIndex: 0,\n      vmin,\n      vmax,\n    }));\n\n    setStatus(`Loaded ${rows.length} rows`);\n  };\n\n  const loadBaselineData = (data: SteeringData) => {\n    if (!data || !Array.isArray(data.rows) || !data.rows.length) {\n      return;\n    }\n    const rows = [...data.rows];\n    const plainRow =\n      rows.find((r) => String(r.label || \"\") === \"plain_prompt\") ||\n      rows.find((r) => !r.system_prompt) ||\n      null;\n    const systemRows = rows.filter((r) => r.system_prompt);\n    const selectedRow = systemRows[0] || plainRow || null;\n\n    const scale = data.delta_color_scale || {};\n    let vmin = Number.isFinite(scale.vmin_p5) ? scale.vmin_p5! : -1;\n    let vmax = Number.isFinite(scale.vmax_p95) ? scale.vmax_p95! : 1;\n    const scaleRow = selectedRow || plainRow;\n    if ((vmin == null || vmax == null) && scaleRow?.delta_logprobs?.length) {\n      const computed = computeScaleFromDeltas(scaleRow.delta_logprobs);\n      vmin = computed.vmin;\n      vmax = computed.vmax;\n    }\n\n    const baseline: BaselineData = {\n      data,\n      rows,\n      plainRow,\n      systemRows,\n      selectedRow,\n      vmin: Number.isFinite(vmin) ? vmin : -1,\n      vmax: Number.isFinite(vmax) ? vmax : 1,\n    };\n\n    setState((prev) => ({ ...prev, baseline }));\n\n    const systemCount = systemRows.length;\n    const statusMsg = systemCount\n      ? `Baseline loaded (${systemCount} system prompt${systemCount > 1 ? \"s\" : \"\"})`\n      : \"Baseline loaded (plain prompt)\";\n    setStatus(statusMsg);\n  };\n\n  const routeJsonData = (data: SteeringData, filename: string) => {\n    const name = (filename || \"\").toLowerCase();\n    const isBaseline =\n      data?.run_type === \"prompt_baseline\" ||\n      name.includes(\"baseline\") ||\n      (Array.isArray(data?.rows) && data.rows.length === 1 && !data.delta_color_scale);\n\n    if (isBaseline) {\n      loadBaselineData(data);\n    } else {\n      loadJsonData(data);\n    }\n  };\n\n  const handleFileChange = (event: ChangeEvent<HTMLInputElement>) => {\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    files.forEach((file) => {\n      const reader = new FileReader();\n      reader.onload = () => {\n        try {\n          const data = JSON.parse(reader.result as string);\n          routeJsonData(data, file.name);\n        } catch (err: any) {\n          setStatus(`Invalid JSON: ${err.message}`);\n        }\n      };\n      reader.readAsText(file);\n    });\n  };\n\n  const handleSliderChange = (event: ChangeEvent<HTMLInputElement>) => {\n    const index = Number(event.target.value || 0);\n    setState((prev) => ({\n      ...prev,\n      currentIndex: Math.max(0, Math.min(index, prev.rows.length - 1)),\n    }));\n  };\n\n  const handleTargetChange = (event: ChangeEvent<HTMLSelectElement>) => {\n    setState((prev) => ({ ...prev, selectedTarget: event.target.value }));\n  };\n\n  const handleBaselineSelectChange = (event: ChangeEvent<HTMLSelectElement>) => {\n    if (!state.baseline || !state.baseline.systemRows?.length) {\n      return;\n    }\n    const idx = Number(event.target.value || 0);\n    const selected = state.baseline.systemRows[idx] || state.baseline.systemRows[0];\n    setState((prev) => ({\n      ...prev,\n      baseline: prev.baseline\n        ? { ...prev.baseline, selectedRow: selected }\n        : null,\n    }));\n  };\n\n  const setActiveTab = (tab: \"frame\" | \"prompt\" | \"concept\" | \"arch\" | \"vector\") => {\n    setState((prev) => ({ ...prev, activeTab: tab }));\n  };\n\n  useEffect(() => {\n    // Try to load default JSON\n    const loadDefault = async () => {\n      try {\n        const res = await fetch(\"/steering_run.json\");\n        if (res.ok) {\n          const data = await res.json();\n          loadJsonData(data);\n        }\n      } catch (err) {\n        // Silently fail - user can upload manually\n      }\n    };\n\n    // Try to load baseline\n    const loadDefaultBaseline = async () => {\n      try {\n        const res = await fetch(\"/prompt_baseline.json\");\n        if (res.ok) {\n          const data = await res.json();\n          loadBaselineData(data);\n        }\n      } catch (err) {\n        // Silently fail\n      }\n    };\n\n    // Try to load steering vector\n    const loadSteeringVector = async () => {\n      try {\n        const res = await fetch(\"/steer_vector.json\");\n        if (res.ok) {\n          const data = await res.json() as SteeringVector;\n          setState((prev) => ({ ...prev, steeringVector: data }));\n        }\n      } catch (err) {\n        // Silently fail\n      }\n    };\n\n    loadDefault();\n    loadDefaultBaseline();\n    loadSteeringVector();\n  }, []);\n\n  const getCurrentRow = (): Row | null => {\n    return state.rows[state.currentIndex] || null;\n  };\n\n  const currentRow = getCurrentRow();\n  const coeff = currentRow ? Number(currentRow.coeff ?? 0) : 0;\n  const entropy = currentRow?.next_token?.entropy;\n  const target = state.selectedTarget;\n  const logprob =\n    target && currentRow?.targets && currentRow.targets[target]\n      ? currentRow.targets[target].logprob\n      : null;\n  const rank =\n    target && currentRow?.targets_first_token && currentRow.targets_first_token[target]\n      ? currentRow.targets_first_token[target].rank\n      : null;\n  const prob =\n    target && currentRow?.targets_first_token && currentRow.targets_first_token[target]\n      ? currentRow.targets_first_token[target].p\n      : null;\n\n  // Build entropy plot series\n  const entropyRows = state.rows.filter(\n    (r) => r.next_token && r.next_token.entropy != null\n  );\n  const entropyPoints = entropyRows.map((r) => ({\n    x: r.coeff ?? 0,\n    y: r.next_token!.entropy,\n  }));\n  const entropySeries = [\n    {\n      name: \"Entropy\",\n      color: \"#2c3e50\",\n      points: entropyPoints,\n    },\n  ];\n  if (state.baseline && entropyPoints.length) {\n    const minX = Math.min(...entropyPoints.map((p) => p.x));\n    const maxX = Math.max(...entropyPoints.map((p) => p.x));\n    if (state.baseline.selectedRow?.next_token?.entropy != null) {\n      const y = state.baseline.selectedRow.next_token.entropy;\n      entropySeries.push({\n        name: \"System prompt\",\n        color: \"#d56a35\",\n        points: [\n          { x: minX, y },\n          { x: maxX, y },\n        ],\n        dash: [6, 6],\n      } as any);\n    }\n    if (state.baseline.plainRow?.next_token?.entropy != null) {\n      const y = state.baseline.plainRow.next_token.entropy;\n      entropySeries.push({\n        name: \"Plain prompt\",\n        color: \"#6c8fb6\",\n        points: [\n          { x: minX, y },\n          { x: maxX, y },\n        ],\n        dash: [2, 6],\n      } as any);\n    }\n  }\n\n  // Build logprob plot series\n  const logprobRows = target\n    ? state.rows.filter((r) => r.targets && r.targets[target])\n    : [];\n  const logprobPoints = logprobRows.map((r) => ({\n    x: r.coeff ?? 0,\n    y: r.targets![target!].logprob,\n  }));\n  const logprobSeries = target\n    ? [\n        {\n          name: target,\n          color: \"#d56a35\",\n          points: logprobPoints,\n        },\n      ]\n    : [];\n  if (state.baseline && logprobPoints.length && target) {\n    const minX = Math.min(...logprobPoints.map((p) => p.x));\n    const maxX = Math.max(...logprobPoints.map((p) => p.x));\n    if (state.baseline.selectedRow?.targets?.[target]) {\n      const y = state.baseline.selectedRow.targets[target].logprob;\n      logprobSeries.push({\n        name: \"System prompt\",\n        color: \"#2c3e50\",\n        points: [\n          { x: minX, y },\n          { x: maxX, y },\n        ],\n        dash: [6, 6],\n      } as any);\n    }\n    if (state.baseline.plainRow?.targets?.[target]) {\n      const y = state.baseline.plainRow.targets[target].logprob;\n      logprobSeries.push({\n        name: \"Plain prompt\",\n        color: \"#6c8fb6\",\n        points: [\n          { x: minX, y },\n          { x: maxX, y },\n        ],\n        dash: [2, 6],\n      } as any);\n    }\n  }\n\n  const markerX = state.rows[state.currentIndex]?.coeff ?? null;\n\n  return (\n    <>\n      <header className=\"hero\">\n        <div className=\"hero-text\">\n          <p className=\"eyebrow\">Lethonium Experimenter</p>\n          <h1>Model Steering Viewer</h1>\n        </div>\n        <div className=\"hero-actions\">\n          <label className=\"file-pill\">\n            <input\n              id=\"jsonFile\"\n              type=\"file\"\n              accept=\".json\"\n              multiple\n              onChange={handleFileChange}\n            />\n            <span>Load JSON(s)</span>\n          </label>\n          <div id=\"status\" className=\"status\">\n            {status}\n          </div>\n        </div>\n      </header>\n\n      <main className=\"layout\">\n        <section className=\"panel frame-panel\">\n          <div className=\"panel-header\">\n            <div className=\"panel-title\">\n              <h2>Frame</h2>\n              <div className=\"panel-tabs\">\n                <button\n                  className={`tab ${state.activeTab === \"frame\" ? \"active\" : \"\"}`}\n                  onClick={() => setActiveTab(\"frame\")}\n                >\n                  Steering sweep\n                </button>\n                <button\n                  className={`tab ${state.activeTab === \"prompt\" ? \"active\" : \"\"}`}\n                  onClick={() => setActiveTab(\"prompt\")}\n                >\n                  Prompt text\n                </button>\n                <button\n                  className={`tab ${state.activeTab === \"vector\" ? \"active\" : \"\"}`}\n                  onClick={() => setActiveTab(\"vector\")}\n                >\n                  Steering vector\n                </button>\n                <button\n                  className={`tab ${state.activeTab === \"concept\" ? \"active\" : \"\"}`}\n                  onClick={() => setActiveTab(\"concept\")}\n                >\n                  Concept\n                </button>\n                <button\n                  className={`tab ${state.activeTab === \"arch\" ? \"active\" : \"\"}`}\n                  onClick={() => setActiveTab(\"arch\")}\n                >\n                  Architecture\n                </button>\n              </div>\n            </div>\n            <div id=\"statRow\" className=\"stat-row\" hidden={state.activeTab !== \"frame\"}>\n              <div className=\"stat\">\n                <div className=\"stat-label\">Coeff</div>\n                <div id=\"coeffValue\" className=\"stat-value\">\n                  {coeff.toFixed(1)}\n                </div>\n              </div>\n              <div className=\"stat\">\n                <div className=\"stat-label\">Entropy</div>\n                <div id=\"entropyValue\" className=\"stat-value\">\n                  {entropy != null ? entropy.toFixed(3) : \"--\"}\n                </div>\n              </div>\n              <div className=\"stat\">\n                <div className=\"stat-label\">Logprob</div>\n                <div id=\"logprobValue\" className=\"stat-value\">\n                  {logprob != null ? logprob.toFixed(3) : \"--\"}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {state.activeTab === \"frame\" && currentRow && (\n            <div id=\"frameView\">\n              <FrameCanvas\n                row={currentRow}\n                data={state.data}\n                vmin={state.vmin}\n                vmax={state.vmax}\n              />\n              <div className=\"controls\">\n                <input\n                  id=\"coeffSlider\"\n                  type=\"range\"\n                  min=\"0\"\n                  max={Math.max(state.rows.length - 1, 0)}\n                  value={state.currentIndex}\n                  step=\"1\"\n                  onChange={handleSliderChange}\n                />\n                <div className=\"slider-meta\">\n                  <span id=\"coeffLabel\">Coeff: {coeff}</span>\n                  <span id=\"promptLabel\">Prompt: {state.data?.prompt || \"\"}</span>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {state.activeTab === \"prompt\" && (\n            <div id=\"promptView\" className=\"prompt-view\">\n              {state.baseline && state.baseline.selectedRow ? (\n                <>\n                  <div className=\"prompt-display-section\">\n                    <h3>Prompt Comparison</h3>\n                    <div className=\"prompt-boxes\">\n                      <div className=\"prompt-box plain\">\n                        <div className=\"prompt-box-header\">\n                          <span className=\"prompt-box-icon\">üìù</span>\n                          <span className=\"prompt-box-title\">Plain Prompt</span>\n                        </div>\n                        <div className=\"prompt-box-content\">\n                          {state.baseline.data?.prompt || state.data?.prompt || \"No prompt available\"}\n                        </div>\n                      </div>\n                      <div className=\"prompt-box system\">\n                        <div className=\"prompt-box-header\">\n                          <span className=\"prompt-box-icon\">‚ú®</span>\n                          <span className=\"prompt-box-title\">\n                            {state.baseline.systemRows.length > 0 && (\n                              <select\n                                className=\"prompt-inline-select\"\n                                onChange={handleBaselineSelectChange}\n                                value={state.baseline.systemRows.findIndex(\n                                  (row) => row === state.baseline?.selectedRow\n                                )}\n                              >\n                                {state.baseline.systemRows.map((row, idx) => (\n                                  <option key={idx} value={idx}>\n                                    {baselineLabel(row)}\n                                  </option>\n                                ))}\n                              </select>\n                            )}\n                          </span>\n                        </div>\n                        <div className=\"prompt-box-content\">\n                          {state.baseline.selectedRow?.system_prompt || \"No system prompt\"}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <FrameCanvas\n                    row={state.baseline.selectedRow}\n                    data={state.baseline.data}\n                    vmin={state.baseline.vmin}\n                    vmax={state.baseline.vmax}\n                    options={{\n                      title: `Prompt baseline ‚Äî ${baselineLabel(\n                        state.baseline.selectedRow\n                      )}`,\n                      subtitle: `Color = Delta logprob (prompted - plain)   |  Tokens: up to ${\n                        state.baseline.data?.max_new_tokens ??\n                        state.data?.max_new_tokens ??\n                        \"\"\n                      }`,\n                      legendLeft: `Less likely with prompt`,\n                      legendRight: `More likely with prompt`,\n                    }}\n                  />\n                </>\n              ) : (\n                <div style={{ padding: \"40px 20px\", color: \"#4a4d50\" }}>\n                  Load a prompt baseline JSON to view this frame.\n                </div>\n              )}\n            </div>\n          )}\n\n          {state.activeTab === \"vector\" && (\n            <div id=\"vectorView\" className=\"vector-view\">\n              {state.steeringVector ? (\n                <>\n                  <div className=\"vector-header\">\n                    <div className=\"vector-info\">\n                      <h3>Steering Vector Distribution</h3>\n                      <div className=\"vector-meta-grid\">\n                        <div className=\"vector-meta-item\">\n                          <span className=\"vector-meta-label\">Model</span>\n                          <span className=\"vector-meta-value\">{state.steeringVector.modelId}</span>\n                        </div>\n                        <div className=\"vector-meta-item\">\n                          <span className=\"vector-meta-label\">Layer</span>\n                          <span className=\"vector-meta-value\">{state.steeringVector.layer}</span>\n                        </div>\n                        <div className=\"vector-meta-item\">\n                          <span className=\"vector-meta-label\">Feature Index</span>\n                          <span className=\"vector-meta-value\">{state.steeringVector.index}</span>\n                        </div>\n                        <div className=\"vector-meta-item\">\n                          <span className=\"vector-meta-label\">Dimensions</span>\n                          <span className=\"vector-meta-value\">{state.steeringVector.vector.length}</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <HistogramCanvas\n                    data={state.steeringVector.vector}\n                    bins={60}\n                    title=\"Value Distribution Across All Dimensions\"\n                  />\n                  <div className=\"vector-description\">\n                    <h4>About This Steering Vector</h4>\n                    <p>\n                      This {state.steeringVector.vector.length}-dimensional vector represents a learned\n                      direction in the model's activation space. When applied to layer {state.data?.layer ?? \"N\"}\n                      during forward passes, it nudges the model's behavior in a specific direction without\n                      changing the input prompt.\n                    </p>\n                    <p>\n                      The histogram shows the distribution of values across all dimensions. Most steering\n                      vectors are sparse, with many dimensions near zero and a few dimensions carrying\n                      most of the steering signal.\n                    </p>\n                  </div>\n                </>\n              ) : (\n                <div style={{ padding: \"40px 20px\", color: \"#4a4d50\", textAlign: \"center\" }}>\n                  <p>No steering vector loaded.</p>\n                  <p style={{ fontSize: \"14px\", marginTop: \"8px\" }}>\n                    Place <code>steer_vector.json</code> in the public folder to view the distribution.\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {state.activeTab === \"concept\" && (\n            <div id=\"conceptView\" className=\"concept-view\">\n              <div className=\"concept-hero\">\n                <h3>What is steering?</h3>\n                <p>\n                  Steering nudges a model&apos;s internal activations in a chosen direction,\n                  without changing the prompt. Here we compare that to classic prompting.\n                </p>\n              </div>\n              <div className=\"concept-grid\">\n                <div className=\"concept-card\">\n                  <h4>Prompting</h4>\n                  <p>\n                    We ask the model to &quot;act like a cat&quot; and measure how token\n                    probabilities shift.\n                  </p>\n                  <p className=\"concept-note\">Output changes come from the instruction alone.</p>\n                </div>\n                <div className=\"concept-card accent\">\n                  <h4>Steering</h4>\n                  <p>\n                    We inject a learned vector at a specific layer and sweep a coefficient to\n                    control strength.\n                  </p>\n                  <p className=\"concept-note\">\n                    Output changes come from internal activation edits.\n                  </p>\n                </div>\n                <div className=\"concept-card\">\n                  <h4>Reading the colors</h4>\n                  <p>\n                    Each token is colored by how much more (red) or less (blue) likely it\n                    becomes under the intervention.\n                  </p>\n                  <p className=\"concept-note\">This makes the shift visible at a glance.</p>\n                </div>\n              </div>\n              <div className=\"concept-footer\">\n                <p>\n                  Goal: find the smallest coefficient that matches the &quot;cat prompt&quot;\n                  baseline, showing steering can reproduce instruction effects without changing\n                  the prompt.\n                </p>\n              </div>\n            </div>\n          )}\n\n          {state.activeTab === \"arch\" && (\n            <div id=\"archView\" className=\"arch-view-modern\">\n              <div className=\"arch-flow\">\n                <div className=\"arch-header-modern\">\n                  <h3>Gemma2ForCausalLM Architecture</h3>\n                  <div className=\"arch-meta\">\n                    <span className=\"arch-badge steering\">\n                      Steering at Layer {state.data?.layer ?? 0}\n                    </span>\n                    <span className=\"arch-badge\">42 Decoder Layers</span>\n                    <span className=\"arch-badge\">3584 Hidden Dim</span>\n                  </div>\n                </div>\n\n                <div className=\"arch-flow-container\">\n                  {/* Input Embedding */}\n                  <div className=\"arch-component embedding\">\n                    <div className=\"arch-component-header\">\n                      <div className=\"arch-component-icon\">üì•</div>\n                      <div>\n                        <div className=\"arch-component-title\">Token Embedding</div>\n                        <div className=\"arch-component-meta\">256K vocab ‚Üí 3584 dim</div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"arch-flow-arrow\">‚Üì</div>\n\n                  {/* Decoder Stack */}\n                  <div className=\"arch-decoder-stack\">\n                    <div className=\"arch-stack-label\">\n                      Transformer Decoder Stack (0-41)\n                    </div>\n\n                    {/* Single expanded layer showing structure */}\n                    <div className={`arch-decoder-layer ${\n                      state.data?.layer != null ? \"has-steering\" : \"\"\n                    }`}>\n                      <div className=\"arch-layer-header\">\n                        <span className=\"arch-layer-number\">\n                          Layer {state.data?.layer ?? \"N\"}\n                        </span>\n                        {state.data?.layer != null && (\n                          <span className=\"arch-steering-badge\">‚ö° Steering Injection</span>\n                        )}\n                      </div>\n\n                      <div className=\"arch-layer-components\">\n                        {/* Attention Block */}\n                        <div className=\"arch-block attention\">\n                          <div className=\"arch-block-header\">\n                            <span className=\"arch-block-icon\">üîç</span>\n                            <span className=\"arch-block-title\">Multi-Head Attention</span>\n                          </div>\n                          <div className=\"arch-block-body\">\n                            <div className=\"arch-param\">\n                              <span className=\"arch-param-name\">input_layernorm</span>\n                              <span className=\"arch-param-value\">RMSNorm(3584)</span>\n                            </div>\n                            <div className=\"arch-projections\">\n                              <div className=\"arch-proj\">Q: 3584 ‚Üí 4096</div>\n                              <div className=\"arch-proj\">K: 3584 ‚Üí 2048</div>\n                              <div className=\"arch-proj\">V: 3584 ‚Üí 2048</div>\n                            </div>\n                            <div className=\"arch-param\">\n                              <span className=\"arch-param-name\">output_proj</span>\n                              <span className=\"arch-param-value\">4096 ‚Üí 3584</span>\n                            </div>\n                            <div className=\"arch-param\">\n                              <span className=\"arch-param-name\">post_attention_layernorm</span>\n                              <span className=\"arch-param-value\">RMSNorm(3584)</span>\n                            </div>\n                          </div>\n                        </div>\n\n                        <div className=\"arch-flow-mini\">+</div>\n\n                        {/* MLP Block */}\n                        <div className=\"arch-block mlp\">\n                          <div className=\"arch-block-header\">\n                            <span className=\"arch-block-icon\">‚öôÔ∏è</span>\n                            <span className=\"arch-block-title\">Feed-Forward MLP</span>\n                          </div>\n                          <div className=\"arch-block-body\">\n                            <div className=\"arch-param\">\n                              <span className=\"arch-param-name\">pre_feedforward_layernorm</span>\n                              <span className=\"arch-param-value\">RMSNorm(3584)</span>\n                            </div>\n                            <div className=\"arch-mlp-flow\">\n                              <div className=\"arch-mlp-proj\">gate: 3584 ‚Üí 14336</div>\n                              <div className=\"arch-mlp-proj\">up: 3584 ‚Üí 14336</div>\n                              <div className=\"arch-mlp-act\">GELU activation</div>\n                              <div className=\"arch-mlp-proj\">down: 14336 ‚Üí 3584</div>\n                            </div>\n                            <div className=\"arch-param\">\n                              <span className=\"arch-param-name\">post_feedforward_layernorm</span>\n                              <span className=\"arch-param-value\">RMSNorm(3584)</span>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"arch-layer-output\">\n                        Hidden State: 3584 dim\n                      </div>\n                    </div>\n\n                    <div className=\"arch-stack-dots\">\n                      <div className=\"dot\"></div>\n                      <div className=\"dot\"></div>\n                      <div className=\"dot\"></div>\n                    </div>\n                  </div>\n\n                  <div className=\"arch-flow-arrow\">‚Üì</div>\n\n                  {/* Final Norm */}\n                  <div className=\"arch-component norm\">\n                    <div className=\"arch-component-header\">\n                      <div className=\"arch-component-icon\">üìä</div>\n                      <div>\n                        <div className=\"arch-component-title\">Final RMSNorm</div>\n                        <div className=\"arch-component-meta\">3584 dim, eps=1e-06</div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"arch-flow-arrow\">‚Üì</div>\n\n                  {/* LM Head */}\n                  <div className=\"arch-component lm-head\">\n                    <div className=\"arch-component-header\">\n                      <div className=\"arch-component-icon\">üì§</div>\n                      <div>\n                        <div className=\"arch-component-title\">Language Model Head</div>\n                        <div className=\"arch-component-meta\">3584 ‚Üí 256K logits</div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </section>\n\n        <aside className=\"panel plots-panel\">\n          <div className=\"plot-card\">\n            <div className=\"plot-header\">\n              <div>\n                <h3>Entropy shift</h3>\n                <p>Overall next-token entropy as steering changes.</p>\n              </div>\n            </div>\n            <PlotCanvas series={entropySeries} markerX={markerX} />\n          </div>\n\n          <div className=\"plot-card\">\n            <div className=\"plot-header\">\n              <div>\n                <h3>Target logprob</h3>\n                <p>Phrase log probability across coefficients.</p>\n              </div>\n              <select\n                id=\"targetSelect\"\n                onChange={handleTargetChange}\n                disabled={!state.targets.length}\n                value={state.selectedTarget || \"\"}\n              >\n                {state.targets.length === 0 ? (\n                  <option value=\"\">No targets</option>\n                ) : (\n                  state.targets.map((t) => (\n                    <option key={t} value={t}>\n                      {formatTargetLabel(t)}\n                    </option>\n                  ))\n                )}\n              </select>\n            </div>\n            <PlotCanvas series={logprobSeries} markerX={markerX} />\n            <div className=\"plot-footer\">\n              <div className=\"metric\">\n                <span className=\"metric-label\">Target rank</span>\n                <span id=\"rankValue\" className=\"metric-value\">\n                  {rank != null ? rank : \"--\"}\n                </span>\n              </div>\n              <div className=\"metric\">\n                <span className=\"metric-label\">Target prob</span>\n                <span id=\"probValue\" className=\"metric-value\">\n                  {prob != null ? prob.toFixed(4) : \"--\"}\n                </span>\n              </div>\n            </div>\n          </div>\n        </aside>\n      </main>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}