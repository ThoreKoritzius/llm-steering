{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/utils.ts"],"sourcesContent":["import { ColorRGB, Row } from \"./types\";\n\nexport const STYLE = {\n  titleFont: \"600 52px 'Fraunces', serif\",\n  bodyFont: \"34px 'Space Grotesk', sans-serif\",\n  metaFont: \"28px 'Space Grotesk', sans-serif\",\n  ink: \"#1a1a1a\",\n  meta: \"#4a4d50\",\n};\n\nexport function clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n\nexport function deltaToColor(delta: number, vmin: number, vmax: number): ColorRGB {\n  const neutral = { r: 247, g: 244, b: 238 };\n  if (vmax <= vmin) {\n    return { ...neutral, css: `rgb(${neutral.r},${neutral.g},${neutral.b})` };\n  }\n  const x = clamp(delta, vmin, vmax);\n  const t = (x - vmin) / (vmax - vmin);\n\n  if (t < 0.5) {\n    const a = Math.pow((0.5 - t) / 0.5, 0.7);\n    const blue = { r: 42, g: 97, b: 216 };\n    const r = Math.round(neutral.r * (1 - a) + blue.r * a);\n    const g = Math.round(neutral.g * (1 - a) + blue.g * a);\n    const b = Math.round(neutral.b * (1 - a) + blue.b * a);\n    return { r, g, b, css: `rgb(${r},${g},${b})` };\n  }\n  const a = Math.pow((t - 0.5) / 0.5, 0.7);\n  const red = { r: 217, g: 67, b: 58 };\n  const r = Math.round(neutral.r * (1 - a) + red.r * a);\n  const g = Math.round(neutral.g * (1 - a) + red.g * a);\n  const b = Math.round(neutral.b * (1 - a) + red.b * a);\n  return { r, g, b, css: `rgb(${r},${g},${b})` };\n}\n\nexport function textColorForBg(color: ColorRGB): string {\n  const luminance = 0.2126 * color.r + 0.7152 * color.g + 0.0722 * color.b;\n  return luminance < 140 ? \"#ffffff\" : \"#1a1a1a\";\n}\n\nexport function computeColorScale(rows: Row[]): { vmin: number; vmax: number } {\n  const deltas: number[] = [];\n  rows.forEach((row) => {\n    const arr = row.delta_logprobs || [];\n    arr.forEach((d) => deltas.push(d));\n  });\n  if (!deltas.length) {\n    return { vmin: -1, vmax: 1 };\n  }\n  deltas.sort((a, b) => a - b);\n  const lo = deltas[Math.floor(deltas.length * 0.05)];\n  const hi = deltas[Math.floor(deltas.length * 0.95)];\n  let vmin = Number.isFinite(lo) ? lo : -1;\n  let vmax = Number.isFinite(hi) ? hi : 1;\n  if (Math.abs(vmax - vmin) < 1e-6) {\n    vmin -= 1;\n    vmax += 1;\n  }\n  return { vmin, vmax };\n}\n\nexport function computeScaleFromDeltas(deltas: number[] | undefined): { vmin: number; vmax: number } {\n  if (!deltas || !deltas.length) {\n    return { vmin: -1, vmax: 1 };\n  }\n  const sorted = [...deltas].sort((a, b) => a - b);\n  const lo = sorted[Math.floor(sorted.length * 0.05)];\n  const hi = sorted[Math.floor(sorted.length * 0.95)];\n  let vmin = Number.isFinite(lo) ? lo : -1;\n  let vmax = Number.isFinite(hi) ? hi : 1;\n  if (Math.abs(vmax - vmin) < 1e-6) {\n    vmin -= 1;\n    vmax += 1;\n  }\n  return { vmin, vmax };\n}\n\nexport function formatTargetLabel(target: string): string {\n  if (typeof target !== \"string\") {\n    return String(target);\n  }\n  if (target.startsWith(\" \")) {\n    return `[space]${target.slice(1)}`;\n  }\n  return target;\n}\n\nexport function baselineLabel(row: Row | null): string {\n  if (!row) {\n    return \"System prompt\";\n  }\n  if (row.label) {\n    return row.label;\n  }\n  if (row.system_prompt) {\n    const text = row.system_prompt.replace(/\\s+/g, \" \").trim();\n    return text;\n  }\n  return \"System prompt\";\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/components/FrameCanvas.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef } from \"react\";\nimport { Row, SteeringData } from \"../types\";\nimport { STYLE, deltaToColor, textColorForBg } from \"../utils\";\n\ninterface FrameCanvasProps {\n  row: Row;\n  data: SteeringData | null;\n  vmin: number;\n  vmax: number;\n  options?: {\n    title?: string;\n    subtitle?: string;\n    prompt?: string;\n    maxTokens?: number | string;\n    layer?: number;\n    legendLeft?: string;\n    legendRight?: string;\n  };\n}\n\nexport default function FrameCanvas({ row, data, vmin, vmax, options = {} }: FrameCanvasProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    const width = canvas.width;\n    const height = canvas.height;\n\n    ctx.clearRect(0, 0, width, height);\n    ctx.fillStyle = \"#ffffff\";\n    ctx.fillRect(0, 0, width, height);\n    ctx.textBaseline = \"top\";\n\n    const margin = 70;\n    const lineSpacing = 10;\n    const titleY = 40;\n    const metaY = 110;\n    const bodyY = 180;\n    const maxX = width - margin;\n\n    const coeff = Number(row.coeff ?? 0).toFixed(0);\n    const layer = options.layer ?? data?.layer ?? \"\";\n    const prompt = options.prompt ?? data?.prompt ?? \"\";\n    const maxTokens = options.maxTokens ?? data?.max_new_tokens ?? \"\";\n\n    ctx.font = STYLE.titleFont;\n    ctx.fillStyle = STYLE.ink;\n    const title = options.title ?? `Steering sweep - coeff = ${coeff}  (layer ${layer})`;\n    ctx.fillText(title, margin, titleY);\n\n    ctx.font = STYLE.metaFont;\n    ctx.fillStyle = STYLE.meta;\n    const subtitle =\n      options.subtitle ??\n      `Prompt: \"${prompt}\"   |  Tokens: up to ${maxTokens}   |  Color = Delta logprob (steered - base)`;\n    ctx.fillText(subtitle, margin, metaY);\n\n    ctx.font = STYLE.bodyFont;\n    const fontSize = 34;\n    const lineHeight = fontSize + lineSpacing;\n    let x = margin;\n    let y = bodyY;\n    const padX = 6;\n    const padY = 4;\n    const tokenGap = 2;\n\n    const pieces = row.generated_pieces || [];\n    const deltas = row.delta_logprobs || [];\n\n    for (let i = 0; i < pieces.length; i += 1) {\n      const piece = pieces[i];\n      const delta = deltas[i] ?? 0;\n      const parts = String(piece).split(\"\\n\");\n      for (let pi = 0; pi < parts.length; pi += 1) {\n        const part = parts[pi];\n        if (part) {\n          const w = ctx.measureText(part).width;\n          if (x + w + padX * 2 > maxX) {\n            x = margin;\n            y += lineHeight;\n          }\n          const color = deltaToColor(delta, vmin, vmax);\n          ctx.fillStyle = color.css;\n          ctx.fillRect(x - padX, y - padY, w + padX * 2, fontSize + padY * 2);\n          ctx.fillStyle = textColorForBg(color);\n          ctx.fillText(part, x, y);\n          x += w + padX * 2 + tokenGap;\n        }\n        if (pi < parts.length - 1) {\n          x = margin;\n          y += lineHeight;\n        }\n      }\n      if (y > height - 120) {\n        break;\n      }\n    }\n\n    const legendY = height - 80;\n    ctx.font = STYLE.metaFont;\n    ctx.fillStyle = STYLE.ink;\n    const legendLeft = options.legendLeft ?? \"Less likely\";\n    const legendRight = options.legendRight ?? \"More likely\";\n    ctx.fillText(legendLeft, margin, legendY - 40);\n    ctx.fillText(legendRight, width - margin - 250, legendY - 40);\n\n    const barX0 = margin;\n    const barX1 = width - margin;\n    const barW = barX1 - barX0;\n    for (let i = 0; i < barW; i += 1) {\n      const t = i / Math.max(barW - 1, 1);\n      const d = vmin + t * (vmax - vmin);\n      ctx.strokeStyle = deltaToColor(d, vmin, vmax).css;\n      ctx.beginPath();\n      ctx.moveTo(barX0 + i, legendY);\n      ctx.lineTo(barX0 + i, legendY + 18);\n      ctx.stroke();\n    }\n  }, [row, data, vmin, vmax, options]);\n\n  return (\n    <div className=\"canvas-wrap\">\n      <canvas ref={canvasRef} width=\"1920\" height=\"520\"></canvas>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;;;AAJA;;;AAsBe,SAAS,YAAY,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,UAAU,CAAC,CAAC,EAAoB;;IAC3F,MAAM,YAAY,IAAA,uKAAM,EAAoB;IAE5C,IAAA,0KAAS;iCAAC;YACR,MAAM,SAAS,UAAU,OAAO;YAChC,IAAI,CAAC,QAAQ;YAEb,MAAM,MAAM,OAAO,UAAU,CAAC;YAC9B,IAAI,CAAC,KAAK;YAEV,MAAM,QAAQ,OAAO,KAAK;YAC1B,MAAM,SAAS,OAAO,MAAM;YAE5B,IAAI,SAAS,CAAC,GAAG,GAAG,OAAO;YAC3B,IAAI,SAAS,GAAG;YAChB,IAAI,QAAQ,CAAC,GAAG,GAAG,OAAO;YAC1B,IAAI,YAAY,GAAG;YAEnB,MAAM,SAAS;YACf,MAAM,cAAc;YACpB,MAAM,SAAS;YACf,MAAM,QAAQ;YACd,MAAM,QAAQ;YACd,MAAM,OAAO,QAAQ;YAErB,MAAM,QAAQ,OAAO,IAAI,KAAK,IAAI,GAAG,OAAO,CAAC;YAC7C,MAAM,QAAQ,QAAQ,KAAK,IAAI,MAAM,SAAS;YAC9C,MAAM,SAAS,QAAQ,MAAM,IAAI,MAAM,UAAU;YACjD,MAAM,YAAY,QAAQ,SAAS,IAAI,MAAM,kBAAkB;YAE/D,IAAI,IAAI,GAAG,wHAAK,CAAC,SAAS;YAC1B,IAAI,SAAS,GAAG,wHAAK,CAAC,GAAG;YACzB,MAAM,QAAQ,QAAQ,KAAK,IAAI,CAAC,yBAAyB,EAAE,MAAM,SAAS,EAAE,MAAM,CAAC,CAAC;YACpF,IAAI,QAAQ,CAAC,OAAO,QAAQ;YAE5B,IAAI,IAAI,GAAG,wHAAK,CAAC,QAAQ;YACzB,IAAI,SAAS,GAAG,wHAAK,CAAC,IAAI;YAC1B,MAAM,WACJ,QAAQ,QAAQ,IAChB,CAAC,SAAS,EAAE,OAAO,qBAAqB,EAAE,UAAU,4CAA4C,CAAC;YACnG,IAAI,QAAQ,CAAC,UAAU,QAAQ;YAE/B,IAAI,IAAI,GAAG,wHAAK,CAAC,QAAQ;YACzB,MAAM,WAAW;YACjB,MAAM,aAAa,WAAW;YAC9B,IAAI,IAAI;YACR,IAAI,IAAI;YACR,MAAM,OAAO;YACb,MAAM,OAAO;YACb,MAAM,WAAW;YAEjB,MAAM,SAAS,IAAI,gBAAgB,IAAI,EAAE;YACzC,MAAM,SAAS,IAAI,cAAc,IAAI,EAAE;YAEvC,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,KAAK,EAAG;gBACzC,MAAM,QAAQ,MAAM,CAAC,EAAE;gBACvB,MAAM,QAAQ,MAAM,CAAC,EAAE,IAAI;gBAC3B,MAAM,QAAQ,OAAO,OAAO,KAAK,CAAC;gBAClC,IAAK,IAAI,KAAK,GAAG,KAAK,MAAM,MAAM,EAAE,MAAM,EAAG;oBAC3C,MAAM,OAAO,KAAK,CAAC,GAAG;oBACtB,IAAI,MAAM;wBACR,MAAM,IAAI,IAAI,WAAW,CAAC,MAAM,KAAK;wBACrC,IAAI,IAAI,IAAI,OAAO,IAAI,MAAM;4BAC3B,IAAI;4BACJ,KAAK;wBACP;wBACA,MAAM,QAAQ,IAAA,+HAAY,EAAC,OAAO,MAAM;wBACxC,IAAI,SAAS,GAAG,MAAM,GAAG;wBACzB,IAAI,QAAQ,CAAC,IAAI,MAAM,IAAI,MAAM,IAAI,OAAO,GAAG,WAAW,OAAO;wBACjE,IAAI,SAAS,GAAG,IAAA,iIAAc,EAAC;wBAC/B,IAAI,QAAQ,CAAC,MAAM,GAAG;wBACtB,KAAK,IAAI,OAAO,IAAI;oBACtB;oBACA,IAAI,KAAK,MAAM,MAAM,GAAG,GAAG;wBACzB,IAAI;wBACJ,KAAK;oBACP;gBACF;gBACA,IAAI,IAAI,SAAS,KAAK;oBACpB;gBACF;YACF;YAEA,MAAM,UAAU,SAAS;YACzB,IAAI,IAAI,GAAG,wHAAK,CAAC,QAAQ;YACzB,IAAI,SAAS,GAAG,wHAAK,CAAC,GAAG;YACzB,MAAM,aAAa,QAAQ,UAAU,IAAI;YACzC,MAAM,cAAc,QAAQ,WAAW,IAAI;YAC3C,IAAI,QAAQ,CAAC,YAAY,QAAQ,UAAU;YAC3C,IAAI,QAAQ,CAAC,aAAa,QAAQ,SAAS,KAAK,UAAU;YAE1D,MAAM,QAAQ;YACd,MAAM,QAAQ,QAAQ;YACtB,MAAM,OAAO,QAAQ;YACrB,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,KAAK,EAAG;gBAChC,MAAM,IAAI,IAAI,KAAK,GAAG,CAAC,OAAO,GAAG;gBACjC,MAAM,IAAI,OAAO,IAAI,CAAC,OAAO,IAAI;gBACjC,IAAI,WAAW,GAAG,IAAA,+HAAY,EAAC,GAAG,MAAM,MAAM,GAAG;gBACjD,IAAI,SAAS;gBACb,IAAI,MAAM,CAAC,QAAQ,GAAG;gBACtB,IAAI,MAAM,CAAC,QAAQ,GAAG,UAAU;gBAChC,IAAI,MAAM;YACZ;QACF;gCAAG;QAAC;QAAK;QAAM;QAAM;QAAM;KAAQ;IAEnC,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAO,KAAK;YAAW,OAAM;YAAO,QAAO;;;;;;;;;;;AAGlD;GA9GwB;KAAA"}},
    {"offset": {"line": 299, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/components/PlotCanvas.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef } from \"react\";\n\ninterface Point {\n  x: number;\n  y: number;\n}\n\ninterface Series {\n  name: string;\n  color: string;\n  points: Point[];\n  dash?: number[];\n}\n\ninterface PlotCanvasProps {\n  series: Series[];\n  markerX?: number | null;\n}\n\nexport default function PlotCanvas({ series, markerX }: PlotCanvasProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    const width = canvas.width;\n    const height = canvas.height;\n    ctx.clearRect(0, 0, width, height);\n\n    // White background\n    ctx.fillStyle = \"#ffffff\";\n    ctx.fillRect(0, 0, width, height);\n\n    const padding = { top: 24, right: 18, bottom: 30, left: 48 };\n    const chartW = width - padding.left - padding.right;\n    const chartH = height - padding.top - padding.bottom;\n\n    const allPoints = series.flatMap((s) => s.points);\n    if (!allPoints.length) {\n      ctx.fillStyle = \"#888\";\n      ctx.font = \"14px 'Space Grotesk', sans-serif\";\n      ctx.fillText(\"No data\", padding.left, padding.top + 10);\n      return;\n    }\n\n    let minX = Math.min(...allPoints.map((p) => p.x));\n    let maxX = Math.max(...allPoints.map((p) => p.x));\n    let minY = Math.min(...allPoints.map((p) => p.y));\n    let maxY = Math.max(...allPoints.map((p) => p.y));\n\n    if (minX === maxX) {\n      minX -= 1;\n      maxX += 1;\n    }\n    if (minY === maxY) {\n      minY -= 1;\n      maxY += 1;\n    }\n\n    const yPad = (maxY - minY) * 0.08;\n    minY -= yPad;\n    maxY += yPad;\n\n    const mapX = (x: number) => padding.left + ((x - minX) / (maxX - minX)) * chartW;\n    const mapY = (y: number) => padding.top + (1 - (y - minY) / (maxY - minY)) * chartH;\n\n    // Grid lines\n    ctx.strokeStyle = \"rgba(0,0,0,0.06)\";\n    ctx.lineWidth = 1;\n    const gridCount = 4;\n    for (let i = 0; i <= gridCount; i += 1) {\n      const y = padding.top + (chartH / gridCount) * i;\n      ctx.beginPath();\n      ctx.moveTo(padding.left, y);\n      ctx.lineTo(padding.left + chartW, y);\n      ctx.stroke();\n    }\n\n    // Axes\n    ctx.strokeStyle = \"rgba(0,0,0,0.2)\";\n    ctx.lineWidth = 1.5;\n    ctx.beginPath();\n    ctx.moveTo(padding.left, padding.top);\n    ctx.lineTo(padding.left, padding.top + chartH);\n    ctx.lineTo(padding.left + chartW, padding.top + chartH);\n    ctx.stroke();\n\n    // Draw series lines\n    series.forEach((s) => {\n      ctx.strokeStyle = s.color;\n      ctx.lineWidth = s.dash ? 2.5 : 3;\n      if (s.dash) {\n        ctx.setLineDash(s.dash);\n      }\n      ctx.beginPath();\n      s.points.forEach((p, idx) => {\n        const x = mapX(p.x);\n        const y = mapY(p.y);\n        if (idx === 0) {\n          ctx.moveTo(x, y);\n        } else {\n          ctx.lineTo(x, y);\n        }\n      });\n      ctx.stroke();\n      if (s.dash) {\n        ctx.setLineDash([]);\n      }\n    });\n\n    // Current position marker\n    if (markerX != null && Number.isFinite(markerX)) {\n      const markerXPos = mapX(markerX);\n      ctx.strokeStyle = \"rgba(213, 106, 53, 0.5)\";\n      ctx.lineWidth = 2;\n      ctx.setLineDash([4, 4]);\n      ctx.beginPath();\n      ctx.moveTo(markerXPos, padding.top);\n      ctx.lineTo(markerXPos, padding.top + chartH);\n      ctx.stroke();\n      ctx.setLineDash([]);\n\n      series.forEach((s) => {\n        const closest = s.points.reduce((acc, p) => {\n          if (!acc) return p;\n          return Math.abs(p.x - markerX) < Math.abs(acc.x - markerX) ? p : acc;\n        }, null as Point | null);\n        if (closest) {\n          const x = mapX(closest.x);\n          const y = mapY(closest.y);\n\n          // White outline for visibility\n          ctx.fillStyle = \"#ffffff\";\n          ctx.beginPath();\n          ctx.arc(x, y, 6, 0, Math.PI * 2);\n          ctx.fill();\n\n          // Colored dot\n          ctx.fillStyle = s.color;\n          ctx.beginPath();\n          ctx.arc(x, y, 4.5, 0, Math.PI * 2);\n          ctx.fill();\n        }\n      });\n    }\n\n    // Y-axis labels\n    ctx.fillStyle = \"#666\";\n    ctx.font = \"11px 'Space Grotesk', monospace\";\n    ctx.textAlign = \"right\";\n    ctx.fillText(minY.toFixed(2), padding.left - 6, padding.top + chartH - 2);\n    ctx.fillText(maxY.toFixed(2), padding.left - 6, padding.top + 10);\n\n    // X-axis labels\n    ctx.textAlign = \"center\";\n    ctx.fillText(minX.toFixed(1), padding.left, height - 8);\n    ctx.fillText(maxX.toFixed(1), padding.left + chartW, height - 8);\n  }, [series, markerX]);\n\n  return (\n    <div className=\"canvas-wrap\">\n      <canvas ref={canvasRef} width=\"640\" height=\"240\"></canvas>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 497, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/components/HistogramCanvas.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef } from \"react\";\n\ninterface HistogramCanvasProps {\n  data: number[];\n  bins?: number;\n  title?: string;\n}\n\nexport default function HistogramCanvas({ data, bins = 50, title = \"Distribution\" }: HistogramCanvasProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !data.length) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    const width = canvas.width;\n    const height = canvas.height;\n    ctx.clearRect(0, 0, width, height);\n\n    ctx.fillStyle = \"#ffffff\";\n    ctx.fillRect(0, 0, width, height);\n\n    const padding = { top: 40, right: 40, bottom: 50, left: 60 };\n    const chartW = width - padding.left - padding.right;\n    const chartH = height - padding.top - padding.bottom;\n\n    // Calculate histogram\n    const min = Math.min(...data);\n    const max = Math.max(...data);\n    const binWidth = (max - min) / bins;\n\n    const histogram: number[] = new Array(bins).fill(0);\n    data.forEach((value) => {\n      const binIndex = Math.min(Math.floor((value - min) / binWidth), bins - 1);\n      histogram[binIndex]++;\n    });\n\n    const maxCount = Math.max(...histogram);\n\n    // Draw title\n    ctx.fillStyle = \"#1a1a1a\";\n    ctx.font = \"600 16px 'Space Grotesk', sans-serif\";\n    ctx.textAlign = \"center\";\n    ctx.fillText(title, width / 2, 24);\n\n    // Draw axes\n    ctx.strokeStyle = \"rgba(0,0,0,0.2)\";\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.moveTo(padding.left, padding.top);\n    ctx.lineTo(padding.left, padding.top + chartH);\n    ctx.lineTo(padding.left + chartW, padding.top + chartH);\n    ctx.stroke();\n\n    // Draw grid lines\n    ctx.strokeStyle = \"rgba(0,0,0,0.05)\";\n    ctx.lineWidth = 1;\n    const gridCount = 5;\n    for (let i = 0; i <= gridCount; i++) {\n      const y = padding.top + (chartH / gridCount) * i;\n      ctx.beginPath();\n      ctx.moveTo(padding.left, y);\n      ctx.lineTo(padding.left + chartW, y);\n      ctx.stroke();\n    }\n\n    // Draw bars with different colors for positive/negative values\n    const barWidth = chartW / bins;\n    const zeroValue = 0;\n    histogram.forEach((count, i) => {\n      const barHeight = (count / maxCount) * chartH;\n      const x = padding.left + i * barWidth;\n      const y = padding.top + chartH - barHeight;\n\n      // Calculate the bin's center value\n      const binCenter = min + (i + 0.5) * binWidth;\n      const isPositive = binCenter >= zeroValue;\n\n      // Gradient fill - red for positive, blue for negative\n      const gradient = ctx.createLinearGradient(x, y, x, padding.top + chartH);\n      if (isPositive) {\n        gradient.addColorStop(0, \"#d56a35\"); // Orange/red\n        gradient.addColorStop(1, \"#e89a6e\");\n        ctx.strokeStyle = \"rgba(213, 106, 53, 0.3)\";\n      } else {\n        gradient.addColorStop(0, \"#4287f5\"); // Blue\n        gradient.addColorStop(1, \"#6fa3f7\");\n        ctx.strokeStyle = \"rgba(66, 135, 245, 0.3)\";\n      }\n      ctx.fillStyle = gradient;\n      ctx.fillRect(x, y, barWidth - 1, barHeight);\n\n      // Outline\n      ctx.strokeRect(x, y, barWidth - 1, barHeight);\n    });\n\n    // Draw Y-axis labels\n    ctx.fillStyle = \"#4a4d50\";\n    ctx.font = \"12px 'Space Grotesk', sans-serif\";\n    ctx.textAlign = \"right\";\n    ctx.textBaseline = \"middle\";\n    for (let i = 0; i <= gridCount; i++) {\n      const y = padding.top + (chartH / gridCount) * i;\n      const value = Math.round(maxCount * (1 - i / gridCount));\n      ctx.fillText(String(value), padding.left - 8, y);\n    }\n\n    // Draw X-axis labels\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"top\";\n    const xLabelCount = 5;\n    for (let i = 0; i <= xLabelCount; i++) {\n      const x = padding.left + (chartW / xLabelCount) * i;\n      const value = min + ((max - min) / xLabelCount) * i;\n      ctx.fillText(value.toFixed(3), x, padding.top + chartH + 8);\n    }\n\n    // Axis labels\n    ctx.fillStyle = \"#2b2f33\";\n    ctx.font = \"600 13px 'Space Grotesk', sans-serif\";\n    ctx.textAlign = \"center\";\n    ctx.fillText(\"Value\", width / 2, height - 12);\n\n    ctx.save();\n    ctx.translate(20, height / 2);\n    ctx.rotate(-Math.PI / 2);\n    ctx.fillText(\"Frequency\", 0, 0);\n    ctx.restore();\n\n    // Statistics box\n    const mean = data.reduce((a, b) => a + b, 0) / data.length;\n    const sortedData = [...data].sort((a, b) => a - b);\n    const median = sortedData[Math.floor(data.length / 2)];\n    const variance = data.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / data.length;\n    const stdDev = Math.sqrt(variance);\n\n    const statsX = padding.left + chartW - 150;\n    const statsY = padding.top + 10;\n    const statsW = 140;\n    const statsH = 90;\n\n    ctx.fillStyle = \"rgba(255, 255, 255, 0.95)\";\n    ctx.fillRect(statsX, statsY, statsW, statsH);\n    ctx.strokeStyle = \"rgba(0, 0, 0, 0.1)\";\n    ctx.lineWidth = 1;\n    ctx.strokeRect(statsX, statsY, statsW, statsH);\n\n    ctx.fillStyle = \"#2b2f33\";\n    ctx.font = \"600 12px 'Space Grotesk', sans-serif\";\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"top\";\n\n    const stats = [\n      `Dimensions: ${data.length}`,\n      `Mean: ${mean.toFixed(4)}`,\n      `Median: ${median.toFixed(4)}`,\n      `Std Dev: ${stdDev.toFixed(4)}`,\n      `Range: [${min.toFixed(3)}, ${max.toFixed(3)}]`,\n    ];\n\n    stats.forEach((stat, i) => {\n      ctx.fillText(stat, statsX + 8, statsY + 8 + i * 16);\n    });\n  }, [data, bins, title]);\n\n  return (\n    <div className=\"canvas-wrap\">\n      <canvas ref={canvasRef} width=\"960\" height=\"480\"></canvas>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 695, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/components/PromptDialog.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\n\ninterface PromptDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelect: (folderName: string) => void;\n  currentPrompt: string | null;\n}\n\nexport default function PromptDialog({ isOpen, onClose, onSelect, currentPrompt }: PromptDialogProps) {\n  const [promptFolders, setPromptFolders] = useState<string[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (isOpen) {\n      setLoading(true);\n      fetch(\"/api/prompts\")\n        .then((res) => res.json())\n        .then((data: string[]) => {\n          setPromptFolders(data);\n          setLoading(false);\n        })\n        .catch((err) => {\n          console.error(\"Failed to load prompts:\", err);\n          setLoading(false);\n        });\n    }\n  }, [isOpen]);\n\n  if (!isOpen) return null;\n\n  const handleSelect = (folderName: string) => {\n    onSelect(folderName);\n    onClose();\n  };\n\n  const formatFolderName = (name: string) => {\n    return name\n      .split(/[-_]/)\n      .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n      .join(\" \");\n  };\n\n  return (\n    <div className=\"dialog-overlay\" onClick={onClose}>\n      <div className=\"dialog-content\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"dialog-header\">\n          <h3>Select Prompt</h3>\n          <button className=\"dialog-close\" onClick={onClose}>\n            ✕\n          </button>\n        </div>\n\n        <div className=\"dialog-body\">\n          {loading ? (\n            <div className=\"dialog-loading\">Loading prompts...</div>\n          ) : (\n            <div className=\"prompt-list\">\n              {promptFolders.map((folder) => (\n                <div\n                  key={folder}\n                  className={`prompt-item ${currentPrompt === folder ? \"active\" : \"\"}`}\n                  onClick={() => handleSelect(folder)}\n                >\n                  <div className=\"prompt-item-header\">\n                    <strong>{formatFolderName(folder)}</strong>\n                    {currentPrompt === folder && (\n                      <span className=\"prompt-item-badge\">Active</span>\n                    )}\n                  </div>\n                  <p className=\"prompt-item-description\">\n                    Load experiment data from {folder}/ folder\n                  </p>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAWe,SAAS,aAAa,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,aAAa,EAAqB;;IAClG,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAW,EAAE;IAC/D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;kCAAC;YACR,IAAI,QAAQ;gBACV,WAAW;gBACX,MAAM,gBACH,IAAI;8CAAC,CAAC,MAAQ,IAAI,IAAI;6CACtB,IAAI;8CAAC,CAAC;wBACL,iBAAiB;wBACjB,WAAW;oBACb;6CACC,KAAK;8CAAC,CAAC;wBACN,QAAQ,KAAK,CAAC,2BAA2B;wBACzC,WAAW;oBACb;;YACJ;QACF;iCAAG;QAAC;KAAO;IAEX,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,eAAe,CAAC;QACpB,SAAS;QACT;IACF;IAEA,MAAM,mBAAmB,CAAC;QACxB,OAAO,KACJ,KAAK,CAAC,QACN,GAAG,CAAC,CAAC,OAAS,KAAK,MAAM,CAAC,GAAG,WAAW,KAAK,KAAK,KAAK,CAAC,IACxD,IAAI,CAAC;IACV;IAEA,qBACE,6LAAC;QAAI,WAAU;QAAiB,SAAS;kBACvC,cAAA,6LAAC;YAAI,WAAU;YAAiB,SAAS,CAAC,IAAM,EAAE,eAAe;;8BAC/D,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;sCAAG;;;;;;sCACJ,6LAAC;4BAAO,WAAU;4BAAe,SAAS;sCAAS;;;;;;;;;;;;8BAKrD,6LAAC;oBAAI,WAAU;8BACZ,wBACC,6LAAC;wBAAI,WAAU;kCAAiB;;;;;6CAEhC,6LAAC;wBAAI,WAAU;kCACZ,cAAc,GAAG,CAAC,CAAC,uBAClB,6LAAC;gCAEC,WAAW,CAAC,YAAY,EAAE,kBAAkB,SAAS,WAAW,IAAI;gCACpE,SAAS,IAAM,aAAa;;kDAE5B,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;0DAAQ,iBAAiB;;;;;;4CACzB,kBAAkB,wBACjB,6LAAC;gDAAK,WAAU;0DAAoB;;;;;;;;;;;;kDAGxC,6LAAC;wCAAE,WAAU;;4CAA0B;4CACV;4CAAO;;;;;;;;+BAX/B;;;;;;;;;;;;;;;;;;;;;;;;;;AAqBvB;GAxEwB;KAAA"}},
    {"offset": {"line": 861, "column": 0}, "map": {"version":3,"sources":["file:///Users/thore/Documents/projects/Lethonium/steering-viewer-nextjs/app/viewer/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, ChangeEvent, useRef } from \"react\";\nimport { AppState, SteeringData, BaselineData, Row, SteeringVector } from \"../types\";\nimport {\n  computeColorScale,\n  computeScaleFromDeltas,\n  formatTargetLabel,\n  baselineLabel,\n} from \"../utils\";\nimport FrameCanvas from \"../components/FrameCanvas\";\nimport PlotCanvas from \"../components/PlotCanvas\";\nimport HistogramCanvas from \"../components/HistogramCanvas\";\nimport PromptDialog from \"../components/PromptDialog\";\n\nconst ARCH_LAYER_COUNT = 42;\n\nexport default function ViewerPage() {\n  const [state, setState] = useState<AppState>({\n    data: null,\n    rows: [],\n    coeffs: [],\n    targets: [],\n    selectedTarget: null,\n    currentIndex: 0,\n    vmin: -1,\n    vmax: 1,\n    baseline: null,\n    steeringVector: null,\n    activeTab: \"frame\",\n  });\n\n  const [selectedModel, setSelectedModel] = useState(\"Gemma2ForCausalLM\");\n  const [status, setStatus] = useState(\"Waiting for data...\");\n  const [showBaseline, setShowBaseline] = useState(true);\n  const [promptDialogOpen, setPromptDialogOpen] = useState(false);\n  const [currentPromptFile, setCurrentPromptFile] = useState<string | null>(null);\n\n  const loadJsonData = (data: SteeringData) => {\n    if (!data || !Array.isArray(data.rows)) {\n      setStatus(\"Invalid JSON: missing rows\");\n      return;\n    }\n\n    const rows = [...data.rows].sort((a, b) => (a.coeff ?? 0) - (b.coeff ?? 0));\n    const coeffs = rows.map((r) => Number(r.coeff ?? 0));\n\n    const targets = Array.isArray(data.targets) ? data.targets : [];\n    let finalTargets = targets;\n    if (!targets.length) {\n      const keys: string[] = [];\n      rows.forEach((row) => {\n        [\"targets\", \"targets_first_token\"].forEach((key) => {\n          const value = row[key as keyof Row];\n          if (value && typeof value === \"object\") {\n            keys.push(...Object.keys(value));\n          }\n        });\n      });\n      finalTargets = [...new Set(keys)];\n    }\n\n    const scale = data.delta_color_scale || {};\n    let vmin = Number.isFinite(scale.vmin_p5) ? scale.vmin_p5! : -1;\n    let vmax = Number.isFinite(scale.vmax_p95) ? scale.vmax_p95! : 1;\n    if (!Number.isFinite(vmin) || !Number.isFinite(vmax)) {\n      const computed = computeColorScale(rows);\n      vmin = computed.vmin;\n      vmax = computed.vmax;\n    }\n\n    setState((prev) => ({\n      ...prev,\n      data,\n      rows,\n      coeffs,\n      targets: finalTargets,\n      selectedTarget: finalTargets[0] || null,\n      currentIndex: 0,\n      vmin,\n      vmax,\n    }));\n\n    setStatus(`Loaded ${rows.length} rows`);\n  };\n\n  const loadBaselineData = (data: SteeringData) => {\n    if (!data || !Array.isArray(data.rows) || !data.rows.length) {\n      return;\n    }\n    const rows = [...data.rows];\n    const plainRow =\n      rows.find((r) => String(r.label || \"\") === \"plain_prompt\") ||\n      rows.find((r) => !r.system_prompt) ||\n      null;\n    const systemRows = rows.filter((r) => r.system_prompt);\n    const selectedRow = systemRows[0] || plainRow || null;\n\n    const scale = data.delta_color_scale || {};\n    let vmin = Number.isFinite(scale.vmin_p5) ? scale.vmin_p5! : -1;\n    let vmax = Number.isFinite(scale.vmax_p95) ? scale.vmax_p95! : 1;\n    const scaleRow = selectedRow || plainRow;\n    if ((vmin == null || vmax == null) && scaleRow?.delta_logprobs?.length) {\n      const computed = computeScaleFromDeltas(scaleRow.delta_logprobs);\n      vmin = computed.vmin;\n      vmax = computed.vmax;\n    }\n\n    const baseline: BaselineData = {\n      data,\n      rows,\n      plainRow,\n      systemRows,\n      selectedRow,\n      vmin: Number.isFinite(vmin) ? vmin : -1,\n      vmax: Number.isFinite(vmax) ? vmax : 1,\n    };\n\n    setState((prev) => ({ ...prev, baseline }));\n\n    const systemCount = systemRows.length;\n    const statusMsg = systemCount\n      ? `Baseline loaded (${systemCount} system prompt${systemCount > 1 ? \"s\" : \"\"})`\n      : \"Baseline loaded (plain prompt)\";\n    setStatus(statusMsg);\n  };\n\n  const routeJsonData = (data: SteeringData, filename: string) => {\n    const name = (filename || \"\").toLowerCase();\n    const isBaseline =\n      data?.run_type === \"prompt_baseline\" ||\n      name.includes(\"baseline\") ||\n      (Array.isArray(data?.rows) && data.rows.length === 1 && !data.delta_color_scale);\n\n    if (isBaseline) {\n      loadBaselineData(data);\n    } else {\n      loadJsonData(data);\n    }\n  };\n\n  const handleFileChange = (event: ChangeEvent<HTMLInputElement>) => {\n    const files = event.target.files ? Array.from(event.target.files) : [];\n    files.forEach((file) => {\n      const reader = new FileReader();\n      reader.onload = () => {\n        try {\n          const data = JSON.parse(reader.result as string);\n          routeJsonData(data, file.name);\n        } catch (err: any) {\n          setStatus(`Invalid JSON: ${err.message}`);\n        }\n      };\n      reader.readAsText(file);\n    });\n  };\n\n  const handleSliderChange = (event: ChangeEvent<HTMLInputElement>) => {\n    const index = Number(event.target.value || 0);\n    setState((prev) => ({\n      ...prev,\n      currentIndex: Math.max(0, Math.min(index, prev.rows.length - 1)),\n    }));\n  };\n\n  const handleTargetChange = (event: ChangeEvent<HTMLSelectElement>) => {\n    setState((prev) => ({ ...prev, selectedTarget: event.target.value }));\n  };\n\n  const handleBaselineSelectChange = (event: ChangeEvent<HTMLSelectElement>) => {\n    if (!state.baseline || !state.baseline.systemRows?.length) {\n      return;\n    }\n    const idx = Number(event.target.value || 0);\n    const selected = state.baseline.systemRows[idx] || state.baseline.systemRows[0];\n    setState((prev) => ({\n      ...prev,\n      baseline: prev.baseline\n        ? { ...prev.baseline, selectedRow: selected }\n        : null,\n    }));\n  };\n\n  const setActiveTab = (tab: \"frame\" | \"prompt\" | \"arch\" | \"vector\") => {\n    setState((prev) => ({ ...prev, activeTab: tab }));\n  };\n\n  const loadPromptFromFolder = async (folderName: string) => {\n    try {\n      setStatus(`Loading ${folderName}...`);\n\n      // Load steering run data\n      const steeringRes = await fetch(`/data/prompts/${folderName}/steering_run.json`);\n      if (steeringRes.ok) {\n        const steeringData = await steeringRes.json();\n        loadJsonData(steeringData);\n      }\n\n      // Load baseline data\n      const baselineRes = await fetch(`/data/prompts/${folderName}/prompt_baseline.json`);\n      if (baselineRes.ok) {\n        const baselineData = await baselineRes.json();\n        loadBaselineData(baselineData);\n      }\n\n      // Load vector data\n      const vectorRes = await fetch(`/data/prompts/${folderName}/steer_vector.json`);\n      if (vectorRes.ok) {\n        const vectorData = await vectorRes.json() as SteeringVector;\n        setState((prev) => ({ ...prev, steeringVector: vectorData }));\n        if (vectorData.modelId) {\n          setSelectedModel(vectorData.modelId);\n        }\n      }\n\n      setCurrentPromptFile(folderName);\n      setStatus(`Loaded ${folderName}`);\n    } catch (err: any) {\n      setStatus(`Error loading ${folderName}: ${err.message}`);\n    }\n  };\n\n  useEffect(() => {\n    // Load default folder on mount\n    loadPromptFromFolder(\"default\");\n  }, []);\n\n  const getCurrentRow = (): Row | null => {\n    return state.rows[state.currentIndex] || null;\n  };\n\n  const currentRow = getCurrentRow();\n  const coeff = currentRow ? Number(currentRow.coeff ?? 0) : 0;\n  const entropy = currentRow?.next_token?.entropy;\n  const target = state.selectedTarget;\n  const logprob =\n    target && currentRow?.targets && currentRow.targets[target]\n      ? currentRow.targets[target].logprob\n      : null;\n  const rank =\n    target && currentRow?.targets_first_token && currentRow.targets_first_token[target]\n      ? currentRow.targets_first_token[target].rank\n      : null;\n  const prob =\n    target && currentRow?.targets_first_token && currentRow.targets_first_token[target]\n      ? currentRow.targets_first_token[target].p\n      : null;\n\n  // Build entropy plot series\n  const entropyRows = state.rows.filter(\n    (r) => r.next_token && r.next_token.entropy != null\n  );\n  const entropyPoints = entropyRows.map((r) => ({\n    x: r.coeff ?? 0,\n    y: r.next_token!.entropy,\n  }));\n  const entropySeries = [\n    {\n      name: \"Entropy\",\n      color: \"#2c3e50\",\n      points: entropyPoints,\n    },\n  ];\n  if (showBaseline && state.baseline && entropyPoints.length) {\n    const minX = Math.min(...entropyPoints.map((p) => p.x));\n    const maxX = Math.max(...entropyPoints.map((p) => p.x));\n    if (state.baseline.selectedRow?.next_token?.entropy != null) {\n      const y = state.baseline.selectedRow.next_token.entropy;\n      entropySeries.push({\n        name: \"System prompt\",\n        color: \"#d56a35\",\n        points: [\n          { x: minX, y },\n          { x: maxX, y },\n        ],\n        dash: [6, 6],\n      } as any);\n    }\n    if (state.baseline.plainRow?.next_token?.entropy != null) {\n      const y = state.baseline.plainRow.next_token.entropy;\n      entropySeries.push({\n        name: \"Plain prompt\",\n        color: \"#6c8fb6\",\n        points: [\n          { x: minX, y },\n          { x: maxX, y },\n        ],\n        dash: [2, 6],\n      } as any);\n    }\n  }\n\n  // Build logprob plot series\n  const logprobRows = target\n    ? state.rows.filter((r) => r.targets && r.targets[target])\n    : [];\n  const logprobPoints = logprobRows.map((r) => ({\n    x: r.coeff ?? 0,\n    y: r.targets![target!].logprob,\n  }));\n  const logprobSeries = target\n    ? [\n      {\n        name: target,\n        color: \"#d56a35\",\n        points: logprobPoints,\n      },\n    ]\n    : [];\n  if (showBaseline && state.baseline && logprobPoints.length && target) {\n    const minX = Math.min(...logprobPoints.map((p) => p.x));\n    const maxX = Math.max(...logprobPoints.map((p) => p.x));\n    if (state.baseline.selectedRow?.targets?.[target]) {\n      const y = state.baseline.selectedRow.targets[target].logprob;\n      logprobSeries.push({\n        name: \"System prompt\",\n        color: \"#2c3e50\",\n        points: [\n          { x: minX, y },\n          { x: maxX, y },\n        ],\n        dash: [6, 6],\n      } as any);\n    }\n    if (state.baseline.plainRow?.targets?.[target]) {\n      const y = state.baseline.plainRow.targets[target].logprob;\n      logprobSeries.push({\n        name: \"Plain prompt\",\n        color: \"#6c8fb6\",\n        points: [\n          { x: minX, y },\n          { x: maxX, y },\n        ],\n        dash: [2, 6],\n      } as any);\n    }\n  }\n\n  const markerX = state.rows[state.currentIndex]?.coeff ?? null;\n\n  return (\n    <div className=\"viewer-container\">\n      {/* Compact Single-Line Header */}\n      <header className=\"viewer-header\">\n        <div className=\"header-flow\">\n          <div className=\"header-item\">\n            <label className=\"header-label\">Model</label>\n            <select\n              className=\"header-select\"\n              value={selectedModel}\n              onChange={(e) => setSelectedModel(e.target.value)}\n            >\n              <option value=\"Gemma2ForCausalLM\">Gemma2ForCausalLM</option>\n              <option value=\"Gemma2-9B-IT\">Gemma2-9B-IT</option>\n              <option value=\"Gemma2-27B-IT\">Gemma2-27B-IT</option>\n            </select>\n          </div>\n\n          <div className=\"header-arrow\">→</div>\n\n          <div className=\"header-item\">\n            <label className=\"header-label\">Steering</label>\n            <div className=\"header-value\">\n              Layer {state.data?.layer ?? \"N\"} / {ARCH_LAYER_COUNT} | {state.data?.max_new_tokens ?? \"--\"} tokens\n            </div>\n          </div>\n\n          <div className=\"header-arrow\">→</div>\n\n          <div className=\"header-item header-prompt\" onClick={() => setPromptDialogOpen(true)}>\n            <label className=\"header-label\">Prompt</label>\n            <div className=\"header-value header-clickable\">\n              {state.data?.prompt || state.baseline?.data?.prompt || \"No prompt loaded\"}\n            </div>\n          </div>\n\n          <label className=\"btn-load\">\n            <input\n              type=\"file\"\n              accept=\".json\"\n              multiple\n              onChange={handleFileChange}\n              style={{ display: \"none\" }}\n            />\n            Load Data\n          </label>\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"viewer-layout\">\n        {/* Left Panel: Visualization */}\n        <section className=\"viewer-panel viewer-main\">\n          <div className=\"panel-header\">\n            <div className=\"panel-tabs\">\n              <button\n                className={`tab ${state.activeTab === \"frame\" ? \"active\" : \"\"}`}\n                onClick={() => setActiveTab(\"frame\")}\n              >\n                Steering Sweep\n              </button>\n              <button\n                className={`tab ${state.activeTab === \"prompt\" ? \"active\" : \"\"}`}\n                onClick={() => setActiveTab(\"prompt\")}\n              >\n                Instructions\n              </button>\n              <button\n                className={`tab ${state.activeTab === \"vector\" ? \"active\" : \"\"}`}\n                onClick={() => setActiveTab(\"vector\")}\n              >\n                Vector\n              </button>\n              <button\n                className={`tab ${state.activeTab === \"arch\" ? \"active\" : \"\"}`}\n                onClick={() => setActiveTab(\"arch\")}\n              >\n                Architecture\n              </button>\n            </div>\n\n            {state.activeTab === \"frame\" && (\n              <div className=\"panel-stats\">\n                <div className=\"stat\">\n                  <span className=\"stat-label\">Coeff</span>\n                  <span className=\"stat-value\">{coeff.toFixed(1)}</span>\n                </div>\n                <div className=\"stat\">\n                  <span className=\"stat-label\">Entropy</span>\n                  <span className=\"stat-value\">{entropy != null ? entropy.toFixed(3) : \"--\"}</span>\n                </div>\n                <div className=\"stat\">\n                  <span className=\"stat-label\">Logprob</span>\n                  <span className=\"stat-value\">{logprob != null ? logprob.toFixed(3) : \"--\"}</span>\n                </div>\n              </div>\n            )}\n          </div>\n\n          <div className=\"panel-content\">\n            {state.activeTab === \"frame\" && currentRow && (\n              <div className=\"frame-view\">\n                <FrameCanvas\n                  row={currentRow}\n                  data={state.data}\n                  vmin={state.vmin}\n                  vmax={state.vmax}\n                />\n                <div className=\"frame-controls\">\n                  <input\n                    type=\"range\"\n                    min=\"0\"\n                    max={Math.max(state.rows.length - 1, 0)}\n                    value={state.currentIndex}\n                    step=\"1\"\n                    onChange={handleSliderChange}\n                    className=\"coeff-slider\"\n                  />\n                  <div className=\"slider-info\">\n                    <span>Coefficient: {coeff.toFixed(1)}</span>\n                    <span>Frame {state.currentIndex + 1} / {state.rows.length}</span>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {state.activeTab === \"prompt\" && (\n              <div className=\"prompt-view\">\n                {state.baseline && state.baseline.systemRows.length > 0 ? (\n                  <>\n                    <div className=\"instruction-selector\">\n                      <label>Select Instruction:</label>\n                      <select\n                        className=\"instruction-select\"\n                        onChange={handleBaselineSelectChange}\n                        value={state.baseline.systemRows.findIndex(\n                          (row) => row === state.baseline?.selectedRow\n                        )}\n                      >\n                        {state.baseline.systemRows.map((row, idx) => (\n                          <option key={idx} value={idx}>\n                            {baselineLabel(row)}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                    <FrameCanvas\n                      row={state.baseline.selectedRow!}\n                      data={state.baseline.data}\n                      vmin={state.baseline.vmin}\n                      vmax={state.baseline.vmax}\n                      options={{\n                        title: `Instruction: ${baselineLabel(state.baseline.selectedRow!)}`,\n                        subtitle: `Δ logprob (instruction - plain) | Max tokens: ${state.baseline.data?.max_new_tokens ?? state.data?.max_new_tokens ?? \"\"\n                          }`,\n                        legendLeft: `Less likely`,\n                        legendRight: `More likely`,\n                      }}\n                    />\n                  </>\n                ) : (\n                  <div className=\"empty-state\">\n                    <p>No instruction data loaded</p>\n                    <p className=\"empty-hint\">Upload a baseline JSON file to compare different instructions</p>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {state.activeTab === \"vector\" && (\n              <div className=\"vector-view\">\n                {state.steeringVector ? (\n                  <>\n                    <div className=\"vector-meta\">\n                      <span><strong>Layer:</strong> {state.steeringVector.layer}</span>\n                      <span><strong>Feature:</strong> {state.steeringVector.index}</span>\n                      <span><strong>Dimensions:</strong> {state.steeringVector.vector.length}</span>\n                    </div>\n                    <VectorStrip data={state.steeringVector.vector} />\n                    <HistogramCanvas\n                      data={state.steeringVector.vector}\n                      bins={60}\n                      title=\"Value Distribution\"\n                    />\n                    <VectorDensity data={state.steeringVector.vector} />\n                  </>\n                ) : (\n                  <div className=\"empty-state\">\n                    <p>No steering vector loaded</p>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {state.activeTab === \"arch\" && (\n              <div className=\"arch-view\">\n                <div className=\"arch-header-section\">\n                  <h3>Gemma2ForCausalLM Architecture</h3>\n                  <div className=\"arch-meta-grid\">\n                    <div className=\"arch-meta-item\">\n                      <span className=\"arch-meta-label\">Model</span>\n                      <span className=\"arch-meta-value\">{selectedModel}</span>\n                    </div>\n                    <div className=\"arch-meta-item\">\n                      <span className=\"arch-meta-label\">Total Layers</span>\n                      <span className=\"arch-meta-value\">{ARCH_LAYER_COUNT}</span>\n                    </div>\n                    <div className=\"arch-meta-item\">\n                      <span className=\"arch-meta-label\">Hidden Size</span>\n                      <span className=\"arch-meta-value\">3584</span>\n                    </div>\n                    <div className=\"arch-meta-item\">\n                      <span className=\"arch-meta-label\">Vocab Size</span>\n                      <span className=\"arch-meta-value\">256K</span>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"arch-flow-container\">\n                  <div className=\"arch-flow\">\n                    {/* Embedding */}\n                    <div className=\"arch-component-card\">\n                      <strong>Token Embedding</strong>\n                      <span className=\"arch-detail\">256K vocab → 3584 dimensions</span>\n                    </div>\n\n                    <div className=\"arch-flow-arrow-large\">↓</div>\n\n                    {/* Decoder Stack */}\n                    <div className=\"arch-decoder-stack\">\n                      <div className=\"arch-decoder-title\">Transformer Decoder Stack</div>\n\n                      <div className=\"arch-active-layer\">\n                        <div className=\"arch-layer-title\">\n                          <strong>Layer {state.data?.layer ?? \"N\"} of 42</strong>\n                          {state.data?.layer != null && (\n                            <div className=\"arch-steering-indicator\">\n                              <span>⚡</span>\n                              <span>Steering Injection Point</span>\n                            </div>\n                          )}\n                        </div>\n\n                        <div className=\"arch-layer-components\">\n                          <div className=\"arch-component-box\">\n                            <div className=\"box-title\">Multi-Head Attention</div>\n                            <div className=\"box-details\">\n                              <div>• input_layernorm: RMSNorm(3584)</div>\n                              <div>• Q projection: 3584 → 4096</div>\n                              <div>• K projection: 3584 → 2048</div>\n                              <div>• V projection: 3584 → 2048</div>\n                              <div>• output_proj: 4096 → 3584</div>\n                              <div>• post_attention_layernorm</div>\n                            </div>\n                          </div>\n\n                          <div className=\"arch-component-box\">\n                            <div className=\"box-title\">Feed-Forward Network</div>\n                            <div className=\"box-details\">\n                              <div>• pre_feedforward_layernorm</div>\n                              <div>• gate projection: 3584 → 14336</div>\n                              <div>• up projection: 3584 → 14336</div>\n                              <div>• GELU activation</div>\n                              <div>• down projection: 14336 → 3584</div>\n                              <div>• post_feedforward_layernorm</div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"arch-ellipsis\">⋮</div>\n                    </div>\n\n                    <div className=\"arch-flow-arrow-large\">↓</div>\n\n                    {/* Final Norm */}\n                    <div className=\"arch-component-card\">\n                      <strong>Final RMSNorm</strong>\n                      <span className=\"arch-detail\">3584 dim, eps=1e-06</span>\n                    </div>\n\n                    <div className=\"arch-flow-arrow-large\">↓</div>\n\n                    {/* LM Head */}\n                    <div className=\"arch-component-card\">\n                      <strong>Language Model Head</strong>\n                      <span className=\"arch-detail\">3584 → 256K logits</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </section>\n\n        {/* Right Panel: Plots */}\n        <aside className=\"viewer-panel viewer-sidebar\">\n          <div className=\"plot-card\">\n            <div className=\"plot-header\">\n              <div>\n                <h3>Entropy Shift</h3>\n                <p>Next-token entropy</p>\n              </div>\n            </div>\n            <PlotCanvas series={entropySeries} markerX={markerX} />\n          </div>\n\n          <div className=\"plot-card\">\n            <div className=\"plot-header\">\n              <div>\n                <h3>Target Logprob</h3>\n                <p>Phrase probability</p>\n              </div>\n              <select\n                onChange={handleTargetChange}\n                disabled={!state.targets.length}\n                value={state.selectedTarget || \"\"}\n                className=\"target-select\"\n              >\n                {state.targets.length === 0 ? (\n                  <option value=\"\">No targets</option>\n                ) : (\n                  state.targets.map((t) => (\n                    <option key={t} value={t}>\n                      {formatTargetLabel(t)}\n                    </option>\n                  ))\n                )}\n              </select>\n            </div>\n            <PlotCanvas series={logprobSeries} markerX={markerX} />\n            <div className=\"plot-footer\">\n              <div className=\"metric\">\n                <span className=\"metric-label\">Rank</span>\n                <span className=\"metric-value\">{rank != null ? rank : \"--\"}</span>\n              </div>\n              <div className=\"metric\">\n                <span className=\"metric-label\">Prob</span>\n                <span className=\"metric-value\">{prob != null ? prob.toFixed(4) : \"--\"}</span>\n              </div>\n            </div>\n          </div>\n\n          {/* Single baseline toggle for all plots */}\n          <div className=\"baseline-toggle-card\">\n            <label>\n              <input\n                type=\"checkbox\"\n                checked={showBaseline}\n                onChange={(e) => setShowBaseline(e.target.checked)}\n              />\n              <span>Show baseline comparison</span>\n            </label>\n          </div>\n        </aside>\n      </main>\n\n      {/* Prompt Selection Dialog */}\n      <PromptDialog\n        isOpen={promptDialogOpen}\n        onClose={() => setPromptDialogOpen(false)}\n        onSelect={loadPromptFromFolder}\n        currentPrompt={currentPromptFile}\n      />\n    </div>\n  );\n}\n\nfunction VectorStrip({ data }: { data: number[] }) {\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !data || !data.length) return;\n\n    const width = 800;\n    const height = 80;\n    canvas.width = width;\n    canvas.height = height;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    ctx.clearRect(0, 0, width, height);\n\n    const maxAbs = data.reduce((m, v) => Math.max(m, Math.abs(v)), 0.0001);\n    const midY = height / 2;\n    const total = data.length;\n    const step = Math.max(1, Math.floor(total / width));\n\n    ctx.strokeStyle = \"rgba(0,0,0,0.2)\";\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    ctx.moveTo(0, midY);\n    ctx.lineTo(width, midY);\n    ctx.stroke();\n\n    for (let x = 0; x < width; x++) {\n      const idx = Math.min(total - 1, Math.floor((x / width) * total));\n      const val = data[idx];\n      const magnitude = Math.min(Math.abs(val) / maxAbs, 1);\n      const barHeight = magnitude * (height / 2);\n      const isPos = val >= 0;\n      ctx.fillStyle = isPos ? \"rgba(66, 135, 245, 0.85)\" : \"rgba(213, 106, 53, 0.85)\";\n      const y = isPos ? midY - barHeight : midY;\n      ctx.fillRect(x, y, 1, barHeight || 1);\n    }\n  }, [data]);\n\n  return (\n    <div className=\"vector-strip-card\">\n      <div className=\"vector-strip-header\">\n        <div>\n          <div className=\"vector-strip-title\">Vector diagram</div>\n          <div className=\"vector-strip-subtitle\">Sign + magnitude across all dimensions</div>\n        </div>\n        <div className=\"vector-strip-legend\">\n          <span className=\"chip-key chip-key-attn\" /> positive\n          <span className=\"chip-key chip-key-mlp\" /> negative\n        </div>\n      </div>\n      <canvas ref={canvasRef} className=\"vector-strip-canvas\" />\n      <div className=\"vector-axis\">\n        <span className=\"axis-y\">activation</span>\n        <span className=\"axis-x\">dimension →</span>\n      </div>\n    </div>\n  );\n}\n\nfunction VectorDensity({ data }: { data: number[] }) {\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !data || !data.length) return;\n\n    const width = 800;\n    const height = 120;\n    canvas.width = width;\n    canvas.height = height;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    ctx.clearRect(0, 0, width, height);\n\n    const bins = 80;\n    const absVals = data.map((v) => Math.abs(v));\n    const maxAbs = absVals.reduce((m, v) => Math.max(m, v), 0.0001);\n    const counts = new Array(bins).fill(0);\n    absVals.forEach((v) => {\n      const bucket = Math.min(bins - 1, Math.floor((v / maxAbs) * bins));\n      counts[bucket] += 1;\n    });\n    const maxCount = counts.reduce((m, v) => Math.max(m, v), 0.0001);\n\n    const barWidth = width / bins;\n    counts.forEach((count, i) => {\n      const h = (count / maxCount) * (height - 20);\n      const x = i * barWidth;\n      const y = height - h;\n      ctx.fillStyle = \"rgba(44, 62, 80, 0.65)\";\n      ctx.fillRect(x, y, Math.max(1, barWidth - 1), h);\n    });\n\n    ctx.strokeStyle = \"rgba(0,0,0,0.2)\";\n    ctx.beginPath();\n    ctx.moveTo(0, height - 0.5);\n    ctx.lineTo(width, height - 0.5);\n    ctx.stroke();\n  }, [data]);\n\n  return (\n    <div className=\"vector-density-card\">\n      <div className=\"vector-strip-header\">\n        <div>\n          <div className=\"vector-strip-title\">Activation density</div>\n          <div className=\"vector-strip-subtitle\">Absolute magnitude histogram (normalized)</div>\n        </div>\n      </div>\n      <canvas ref={canvasRef} className=\"vector-strip-canvas\" />\n      <div className=\"vector-axis\">\n        <span className=\"axis-y\">frequency</span>\n        <span className=\"axis-x\">|value| →</span>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}